(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{344:function(t,s,a){"use strict";a.r(s);var e=a(7),n=Object(e.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"redisæ•°æ®ç»“æ„"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#redisæ•°æ®ç»“æ„"}},[t._v("#")]),t._v(" Redisæ•°æ®ç»“æ„")]),t._v(" "),s("h2",{attrs:{id:"_1-ç®€è¿°"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-ç®€è¿°"}},[t._v("#")]),t._v(" 1. ç®€è¿°")]),t._v(" "),s("p",[t._v("æƒ³å¿…å¤§å®¶å·²ç»äº†è§£äº†Redisçš„å‡ å¤§"),s("code",[t._v("æ•°æ®ç»“æ„")]),t._v("ï¼Œé‚£ä¹ˆ"),s("code",[t._v("æ•°æ®ç±»å‹")]),t._v("æ˜¯ä»€ä¹ˆï¼Ÿ")]),t._v(" "),s("p",[t._v("ğŸ˜œå…¶å®æ˜¯æˆ‘è‡ªå·±ç¼–çš„ï¼Œä¸ºäº†è®©è‡ªå·±ç†è§£è¿™äº›ä¸œè¥¿é€ å‡ºæ¥çš„~~")]),t._v(" "),s("blockquote",[s("p",[t._v("æ•°æ®ç»“æ„ ï¼šåƒstringã€setã€listã€zsetï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨çš„è¿™äº›Rediså…·ä½“çš„ç±»å‹ã€‚")]),t._v(" "),s("p",[t._v("æ•°æ®ç±»å‹ ï¼šä¸Šè¿°æ•°æ®ç»“æ„åº•å±‚çš„å®ç°ã€‚")])]),t._v(" "),s("p",[t._v("è¯¥å¦‚ä½•ç†è§£è¿™ä¸¤ä¸ªè¯å‘¢ï¼Ÿ")]),t._v(" "),s("p",[t._v("å­¦ä¹ å„ç§è¯­è¨€éƒ½æ˜¯å…ˆå­¦å„ç§æ•°æ®ç±»å‹ï¼Œä¾‹å¦‚intã€floatã€char...")]),t._v(" "),s("p",[t._v("å†å­¦å„ç§æ•°æ®ç»“æ„ï¼Œä¾‹å¦‚æ ˆã€é˜Ÿåˆ—ã€æ ‘...")]),t._v(" "),s("p",[t._v("æ•°æ®ç»“æ„ç”±æ•°æ®ç±»å‹ç»„æˆï¼Œå°±åƒæ ˆã€é˜Ÿåˆ—è¿™äº›ç»“æ„çš„åº•å±‚å¯ä»¥ç”±æ•°ç»„å®ç°ã€‚")]),t._v(" "),s("p",[t._v("æœ¬ç¯‡å°†ä¼šè®²è¿°ä»¥ä¸‹å†…å®¹ ï¼š")]),t._v(" "),s("ul",[s("li",[t._v("æ•°æ®ç±»å‹ ï¼šSDSã€Intsetã€Ditã€ZipListã€QuickListã€SkipList")]),t._v(" "),s("li",[t._v("ç”¨äºç¡®è®¤æ•°æ®ç»“æ„ä½¿ç”¨å“ªç§æ•°æ®ç»“æ„çš„"),s("code",[t._v("RedisObject")])]),t._v(" "),s("li",[t._v("æ•°æ®ç±»å‹ ï¼šstringã€listã€setã€zsetã€Hashä»¥åŠå®ƒä»¬çš„åº”ç”¨åœºæ™¯ã€‚")])]),t._v(" "),s("p",[t._v("å†è¯´ä¸€å¥ï¼æœ¬æ–‡çš„æ•°æ®ç±»å‹ã€æ•°æ®ç»“æ„éƒ½æ˜¯æœ¬äººæœæ’°ï¼ä¾¿äºè‡ªå·±ç†è§£ï¼Œå®é™…ä¸Šå®ƒä»¬éƒ½æ˜¯"),s("code",[t._v("æ•°æ®ç±»å‹")])]),t._v(" "),s("h2",{attrs:{id:"_2-æ•°æ®ç±»å‹"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-æ•°æ®ç±»å‹"}},[t._v("#")]),t._v(" 2. æ•°æ®ç±»å‹")]),t._v(" "),s("p",[t._v("çœ‹äº†ä¸€äº›é¢è¯•é¢˜ï¼Œå‡ºç°"),s("code",[t._v("Redisæ•°æ®ç±»å‹")]),t._v("è¿™ä¸€å—çŸ¥è¯†çš„ï¼Œå¯¹äºSDSå’ŒSkipListè¾ƒå¤šï¼ŒDictä¹Ÿæœ‰ï¼ŒIntsetã€ZipListã€QuickListå°±æ¯”è¾ƒå°‘äº†ã€‚")]),t._v(" "),s("p",[t._v("ä¸»è¦è¿˜æ˜¯å®ƒä»¬çš„åº”ç”¨åœºæ™¯ã€‚")]),t._v(" "),s("h3",{attrs:{id:"_2-1-sdsåŠ¨æ€å­—ç¬¦ä¸²"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-sdsåŠ¨æ€å­—ç¬¦ä¸²"}},[t._v("#")]),t._v(" 2.1 SDSåŠ¨æ€å­—ç¬¦ä¸²")]),t._v(" "),s("p",[t._v("Redisæ„å»ºäº†ä¸€ç§ç»“æ„ä½“æ¥å®Œæˆå­˜å‚¨å­—ç¬¦ä¸²çš„åŠŸèƒ½ï¼š"),s("strong",[s("code",[t._v("ç®€å•åŠ¨æ€å­—ç¬¦ä¸²")])]),t._v("ï¼ˆ"),s("code",[t._v("S")]),t._v("imple "),s("code",[t._v("D")]),t._v("ynamic "),s("code",[t._v("S")]),t._v("tringï¼‰ï¼Œç®€ç§°SDSã€‚")]),t._v(" "),s("div",{staticClass:"language-c extra-class"},[s("pre",{pre:!0,attrs:{class:"language-c"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("struct")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("__attribute__")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("__packed__"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("sdshdr8")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("char")]),t._v(" buf"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("uint8_t")]),t._v(" alloc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n    "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("uint8_t")]),t._v(" len"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("unsigned")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("char")]),t._v(" flags"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("ul",[s("li",[s("code",[t._v("char buf[]")]),t._v(" ï¼šå­—èŠ‚æ•°ç»„ï¼Œç”¨äºå­˜å‚¨string/int/floatã€‚")]),t._v(" "),s("li",[s("code",[t._v("uint8_t alloc")]),t._v(" ï¼šè®°å½•bufæ•°ç»„ç”³è¯·çš„æ€»å­—èŠ‚æ•°,ç±»å‹ä¸º8ä½æ— ç¬¦å·æ•´å‹ã€‚ä¸åŒ…æ‹¬ç»“æŸæ ‡å¿—'\\0'ã€‚")]),t._v(" "),s("li",[s("code",[t._v("uint8_t len")]),t._v(" ï¼šè®°å½•bufæ•°ç»„ä¸­å·²ç»ä½¿ç”¨çš„å­—èŠ‚çš„æ•°é‡,ç±»å‹ä¸º:8ä½æ— ç¬¦å·æ•´å‹ã€‚ä¸åŒ…æ‹¬ç»“æŸæ ‡å¿—ã€‚")]),t._v(" "),s("li",[s("code",[t._v("unsigned char flags")]),t._v(" ï¼šè®°å½•SDSçš„æœ€å¤§ç©ºé—´ï¼Œå³å†³å®šallocçš„æœ€å¤§å€¼ã€‚å› ä¸ºå­˜å‚¨ç©ºé—´ä¸åŒï¼ŒSDSç±»å‹ä¹Ÿä¸åŒï¼Œæœ‰å¾ˆå¤šä¸åŒç±»å‹çš„SDSï¼Œä¾‹å¦‚16ä½ã€32ä½...")])]),t._v(" "),s("p",[t._v("ä¹‹æ‰€ä»¥è¢«ç§°ä¸ºåŠ¨æ€å­—ç¬¦ä¸²ï¼Œå› ä¸ºè¿™ä¸ªå­—ç¬¦ä¸²æœ‰"),s("code",[t._v("åŠ¨æ€æ‰©å®¹æœºåˆ¶")]),t._v("ï¼š")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("æ‰©å®¹å")]),t._v("çš„ç©ºé—´å°äº1M ï¼šæ‰©å®¹åçš„ç©ºé—´å¤§å°ä¹˜ä»¥ 2ï¼‹1")]),t._v(" "),s("li",[s("code",[t._v("æ‰©å®¹å")]),t._v("çš„ç©ºé—´å¤§äº1M ï¼šç©ºé—´ç›´æ¥ +1M+1")])]),t._v(" "),s("div",{staticClass:"language-markdown extra-class"},[s("pre",{pre:!0,attrs:{class:"language-markdown"}},[s("code",[s("span",{pre:!0,attrs:{class:"token title important"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("#")]),t._v(" æ‰©å®¹æ–¹æ¡ˆ:")]),t._v("\nni -> nihao\n"),s("span",{pre:!0,attrs:{class:"token title important"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("#")]),t._v(" åŸç©ºé—´: ")]),t._v("\n    len=2\n    alloc=2\n"),s("span",{pre:!0,attrs:{class:"token title important"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("#")]),t._v(" æ‰©å®¹å:")]),t._v("\n    len=5\n    alloc=10\n"),s("span",{pre:!0,attrs:{class:"token title important"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("#")]),t._v(" ä¸ºä»€ä¹ˆæ²¡æœ‰åŠ ä¸€ï¼Ÿä¸åº”è¯¥æ˜¯5*2 + 1 = 11å—?")]),t._v("\n    å› ä¸ºå­—ç¬¦ä¸²åé¢æœ‰ '\\0', è€Œè¿™lenå’Œallocä¸¤ä¸ªå­—æ®µéƒ½ä¸è®¡ç®—ç»“æŸæ ‡å¿—ã€‚\n    ç©ºé—´ç¡®å®æœ‰äº†ï¼Œä½†æ˜¯allocæ²¡æœ‰è®¡ç®—è¿›å»ã€‚\n")])])]),s("p",[t._v("ä½†æ˜¯allocçš„ç±»å‹æ˜¯8ä½æ— ç¬¦å·æ•´å‹ï¼Œåªèƒ½å­˜å‚¨2^8ä¸ªæ•°å­—ï¼Œå¤ªæœ‰é™ï¼Œæ‰€ä»¥Redisæä¾›äº†ä¸åŒç±»å‹çš„SDSï¼Œå®ƒä»¬çš„å…¶ä»–ç‰¹æ€§éƒ½ç›¸åŒï¼Œåªæœ‰allocã€lençš„ç±»å‹ä¸åŒï¼Œæœ‰5ä½ã€8ä½ã€16ä½ã€32ä½ã€‚")]),t._v(" "),s("p",[t._v("å¦‚ä½•åŒºåˆ†ï¼Ÿä½¿ç”¨ "),s("code",[t._v("flag")]),t._v(" è¿™ä¸ªå­—æ®µã€‚flagæœ‰ä¸åŒçš„å€¼ï¼Œåˆ†åˆ«ä»£è¡¨å­—èŠ‚å¤§å°ï¼Œ5ã€8ã€16ã€32.")]),t._v(" "),s("img",{staticStyle:{zoom:"67%"},attrs:{src:"https://typorehwf.oss-cn-chengdu.aliyuncs.com/image-20221212203840905.png",alt:"image-20221212203840905"}}),t._v(" "),s("p",[t._v("æ€»ç»“ ï¼šflagè§„å®šallocçš„æœ€å¤§å€¼ï¼Œéœ€è¦æ‰©å®¹æ—¶éœ€è¦æ”¹å˜allocç”šè‡³flagã€‚allocè§„å®šå­—ç¬¦ä¸²å¯ä»¥å­˜å‚¨å¤šå°‘å…ƒç´ ï¼Œä¸€æ—¦è¶…è¿‡ï¼Œéœ€è¦æ‰©å®¹ã€‚lenæ˜¯å½“å‰å…ƒç´ ä¸ªæ•°ã€‚buf[]å­˜å‚¨å½“å‰å…ƒç´ ã€‚")]),t._v(" "),s("h3",{attrs:{id:"_2-2-intset"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-intset"}},[t._v("#")]),t._v(" 2.2 Intset")]),t._v(" "),s("p",[t._v("Intsetæ˜¯Redisä¸­seté›†åˆçš„ä¸€ç§å®ç°æ–¹å¼ï¼ŒåŸºäºæ•´æ•°æ•°ç»„æ¥å®ç°ï¼Œå…·æœ‰"),s("code",[t._v("é•¿åº¦å¯å˜")]),t._v("ã€"),s("code",[t._v("å”¯ä¸€")]),t._v("ã€"),s("code",[t._v("æœ‰åº")]),t._v("ç­‰ç‰¹ç‚¹ã€‚")]),t._v(" "),s("div",{staticClass:"language-c extra-class"},[s("pre",{pre:!0,attrs:{class:"language-c"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typedef")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("struct")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("intset")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("uint32_t")]),t._v(" encoding"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    \n    "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("uint32_t")]),t._v(" length"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    \n    "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("int8_t")]),t._v(" contents"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" intset"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("ul",[s("li",[s("code",[t._v("uint32_t encoding")]),t._v(" ï¼šæ•°æ®ç¼–ç æ–¹å¼ï¼Œæ”¯æŒå­˜æ”¾16ä½ã€32ä½ã€64ä½çš„æ•°æ®ã€‚")]),t._v(" "),s("li",[s("code",[t._v("uint32_t length")]),t._v(" ï¼šå…ƒç´ ä¸ªæ•°ã€‚")]),t._v(" "),s("li",[s("code",[t._v("int8_t contents[]")]),t._v(" ï¼šæ•´æ•°æ•°ç»„ï¼Œä¿å­˜é›†åˆæ•°æ®ã€‚æ•°æ®èŒƒå›´ç”±encodingç¡®è®¤ã€‚")])]),t._v(" "),s("blockquote",[s("p",[t._v("é‚£ä¹ˆIntsetå¦‚ä½•ç»´æŒ"),s("code",[t._v("æœ‰åº")]),t._v("ã€"),s("code",[t._v("å”¯ä¸€")]),t._v("çš„ç‰¹ç‚¹ï¼Ÿ")])]),t._v(" "),s("p",[t._v("åœ¨æ’å…¥æ—¶ ï¼š")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("æ£€æŸ¥æ’å…¥æ•°æ®æ˜¯å¦å¤ªå¤§æˆ–å¤ªå°ï¼Œæ˜¯å¦éœ€è¦æ”¹å˜encodingç¼–ç ã€‚")]),t._v(" "),s("p",[t._v("å¦‚æœé‡ç½®ç¼–ç ï¼Œå‡å¦‚é‡ç½®ç¼–ç ååŸæ¥çš„16ä½å˜æˆ32ä½ï¼Œéœ€è¦é‡æ–°æ‹·è´æ•°ç»„çš„åŸæœ‰æ•°æ®åˆ°å‡çº§åçš„å†…å­˜è€Œä¸”éœ€è¦å€’åºæ‹·è´é˜²æ­¢æ•°æ®ä¸¢å¤±ã€‚")])]),t._v(" "),s("li",[s("p",[t._v("æŸ¥çœ‹æ•°ç»„ä¸­æ˜¯å¦å·²ç»å­˜åœ¨è¯¥æ•°æ®ï¼Œè‹¥å·²å­˜åœ¨å°±ä¸æ’å…¥ï¼Œè‹¥ä¸å­˜åœ¨ï¼ŒäºŒåˆ†æ³•è·å¾—è¯¥æ•°æ®çš„æ’å…¥ä½ç½®ã€‚")]),t._v(" "),s("p",[t._v("äºŒåˆ†æ³•ä¿è¯æ•°æ®æœ‰åºï¼Œæ•°æ®æœ‰åºå¯ä»¥ä½¿ç”¨äºŒåˆ†æ³•ã€‚")])]),t._v(" "),s("li",[s("p",[t._v("æ•°ç»„åŸåœ°æ‰©å®¹ï¼Œå°†å¾…æ’å…¥å…ƒç´ æ’å…¥")])])]),t._v(" "),s("p",[t._v("é€šè¿‡ç¬¬äºŒç‚¹å°±å¯ä»¥ä¿è¯Intsetçš„å”¯ä¸€æ€§å’Œæœ‰åºæ€§ã€‚")]),t._v(" "),s("p",[t._v("ä¸Šè¿°å…·ä½“æ­¥éª¤å¯ä»¥æ‰“å¼€Redisæºç é˜…è¯»ã€‚å°†Rediå®‰è£…åŒ…æ‰“å¼€å³å¯ã€‚")]),t._v(" "),s("h3",{attrs:{id:"_2-3-dict"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-dict"}},[t._v("#")]),t._v(" 2.3 Dict")]),t._v(" "),s("p",[t._v("Redisæ˜¯å…¸å‹çš„é”®å€¼å‹ï¼ˆkey-valueï¼‰æ•°æ®åº“ï¼Œå®ƒå°±æ˜¯é "),s("code",[t._v("Dict")]),t._v("æ¥ä¿æŒé”®ä¸å€¼çš„æ˜ å°„å…³ç³»çš„ã€‚")]),t._v(" "),s("p",[t._v("Javaä¸­çš„Mapæ˜¯åŸºäºHashçš„å­—å…¸ç»“æ„ï¼ŒRedisä¸­çš„å­—å…¸Dictä¹Ÿæ˜¯ã€‚")]),t._v(" "),s("p",[s("code",[t._v("Dict")]),t._v("ç”±ä¸‰éƒ¨åˆ†ç»„æˆ ï¼šå“ˆå¸ŒèŠ‚ç‚¹ï¼ˆDictEntryï¼‰ã€å“ˆå¸Œè¡¨ï¼ˆDictHashTableï¼‰ã€å­—å…¸ï¼ˆDictï¼‰ã€‚")]),t._v(" "),s("img",{staticStyle:{zoom:"50%"},attrs:{src:"https://typorehwf.oss-cn-chengdu.aliyuncs.com/image-20230128144750887.png",alt:"image-20230128144750887"}}),t._v(" "),s("p",[t._v("ä»å°å¾€å¤§è¯´ï¼Œå…ˆè¯´å“ˆå¸ŒèŠ‚ç‚¹ä¸å“ˆå¸Œè¡¨ï¼Œä¸€ä¸ªå“ˆå¸Œè¡¨å¯ä»¥åŒ…å«å¤šä¸ªå“ˆå¸ŒèŠ‚ç‚¹ï¼Œå“ˆå¸ŒèŠ‚ç‚¹æ˜¯é”®-å€¼å‹çš„ã€‚")]),t._v(" "),s("p",[s("code",[t._v("å“ˆå¸ŒèŠ‚ç‚¹ï¼š")])]),t._v(" "),s("div",{staticClass:"language-c extra-class"},[s("pre",{pre:!0,attrs:{class:"language-c"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typedef")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("struct")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("dictEntry")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("key"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    \n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("union")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("val"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("uint64_t")]),t._v(" u64"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("int64_t")]),t._v(" s64"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("double")]),t._v(" d"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" value"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    \n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("struct")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("dictEntry")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("next"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" dictEntry"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("ul",[s("li",[s("code",[t._v("key")]),t._v("ï¼šå“ˆå¸ŒèŠ‚ç‚¹çš„é”®ã€‚")]),t._v(" "),s("li",[s("code",[t._v("value")]),t._v(" ï¼šå“ˆå¸ŒèŠ‚ç‚¹çš„å€¼ï¼Œä¸ºè”åˆä½“ç±»å‹ã€‚")]),t._v(" "),s("li",[s("code",[t._v("*next")]),t._v(" ï¼šä¸ºäº†æ–¹ä¾¿å¯»å€ï¼Œæ¯ä¸ªå“ˆå¸ŒèŠ‚ç‚¹éƒ½æœ‰æŒ‡å‘ä¸‹ä¸€ä¸ªå“ˆå¸ŒèŠ‚ç‚¹çš„æŒ‡é’ˆã€‚")])]),t._v(" "),s("p",[s("code",[t._v("å“ˆå¸Œè¡¨ ï¼š")])]),t._v(" "),s("div",{staticClass:"language-c extra-class"},[s("pre",{pre:!0,attrs:{class:"language-c"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typedef")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("struct")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("dictht")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    dictEntry "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("table"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("unsigned")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("long")]),t._v(" size"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("unsigned")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("long")]),t._v(" sizemask"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("unsigned")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("long")]),t._v(" used"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" dictht"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("   \n")])])]),s("ul",[s("li",[s("code",[t._v("table")]),t._v(" ï¼šæŒ‡å‘é”®å€¼å¯¹æ•°ç»„çš„æŒ‡é’ˆã€‚æ•°ç»„æ˜¯æŒ‡é’ˆï¼Œtableæ˜¯æŒ‡å‘æ•°ç»„çš„æŒ‡é’ˆï¼Œæ‰€ä»¥tableæ˜¯äºŒçº§æŒ‡é’ˆã€‚")]),t._v(" "),s("li",[s("code",[t._v("size")]),t._v(" ï¼šå“ˆå¸Œè¡¨å¤§å°ã€‚æ€»ç­‰äº 2^n ï¼ˆnä¸ºæ•´æ•°ï¼‰ã€‚")]),t._v(" "),s("li",[s("code",[t._v("sizemark")]),t._v(" ï¼šå“ˆå¸Œè¡¨å¤§å°çš„æ©ç ï¼Œæ€»ç­‰äºsize - 1 ã€‚")]),t._v(" "),s("li",[s("code",[t._v("used")]),t._v(" ï¼šå“ˆå¸ŒèŠ‚ç‚¹ä¸ªæ•°ã€‚")])]),t._v(" "),s("p",[t._v("ä¸ºä»€ä¹ˆæœ‰äº†sizeè¡¨ç¤ºå“ˆå¸ŒèŠ‚ç‚¹ä¸ªæ•°ï¼Œè¿˜è¦ä½¿ç”¨usedå¤šæ­¤ä¸€ä¸¾å‘¢ï¼Ÿ")]),t._v(" "),s("p",[t._v("Hashè¿ç®—ä¼šäº§ç”ŸHashå†²çªï¼Œä¼šåœ¨æ•°ç»„çš„åŸºç¡€ä¸Šå¤šä¸€äº›é“¾è¡¨ï¼Œsizeè¡¨ç¤ºæ•°ç»„å…ƒç´ ä¸ªæ•°ï¼Œusedè¡¨ç¤ºæ•°ç»„+é“¾è¡¨çš„å…ƒç´ ä¸ªæ•°ã€‚")]),t._v(" "),s("p",[t._v("å½“æˆ‘ä»¬å‘Dictæ·»åŠ é”®å€¼å¯¹æ—¶ï¼ŒRedisé¦–å…ˆæ ¹æ®keyè®¡ç®—å‡ºhashå€¼ï¼Œç„¶åé€šè¿‡hash & sizemarkè®¡ç®—è¯¥æ•°æ®åº”è¯¥æ”¾åˆ°æ•°ç»„ä¸­å“ªä¸ªä½ç½®ã€‚")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://typorehwf.oss-cn-chengdu.aliyuncs.com/image-20230129120039787.png",alt:"image-20230129120039787"}})]),t._v(" "),s("p",[t._v("é™¤äº†å“ˆå¸ŒèŠ‚ç‚¹ä¸å“ˆå¸Œè¡¨ä¹‹å¤–ï¼ŒDictæœ€åä¸€ä¸ªç»„æˆï¼š"),s("code",[t._v("å­—å…¸ DictHashTable")]),t._v(".")]),t._v(" "),s("div",{staticClass:"language-c extra-class"},[s("pre",{pre:!0,attrs:{class:"language-c"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typedef")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("struct")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("dict")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\tdictType "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("type"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("privdata"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    dictht ht"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("long")]),t._v(" rehashidx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("int16_t")]),t._v(" pauserehash"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("ul",[s("li",[s("code",[t._v("*type")]),t._v("ï¼šæœ¬å­—å…¸çš„ç±»å‹ï¼Œä¸åŒç±»å‹ä½¿ç”¨ä¸åŒHashå‡½æ•°ã€‚")]),t._v(" "),s("li",[s("code",[t._v("*privdata")]),t._v(" ï¼šç§æœ‰æ•°æ®ï¼Œåœ¨åšç‰¹æ®Šhashè¿ç®—æ—¶ä½¿ç”¨ã€‚")]),t._v(" "),s("li",[s("code",[t._v("ht[2]")]),t._v(" ï¼šä¸€ä¸ªå­—å…¸æ‹¥æœ‰ä¸¤ä¸ªå“ˆå¸Œè¡¨ï¼Œä¸€ä¸ªæ”¾å“ˆå¸ŒèŠ‚ç‚¹ï¼Œä¸€ä¸ªä¸ºrehashæ—¶ä½¿ç”¨ã€‚")]),t._v(" "),s("li",[s("code",[t._v("rehashidx")]),t._v(" ï¼šrehashçš„è¿›åº¦ï¼Œ-1ä»£è¡¨æœªå¼€å§‹ã€‚")]),t._v(" "),s("li",[s("code",[t._v("pauserehash")]),t._v(" ï¼šrehashæ˜¯å¦æš‚åœï¼Œ1åˆ™æš‚åœï¼Œ0åˆ™ç»§ç»­ã€‚")])]),t._v(" "),s("p",[t._v("æ€»ç»“ ï¼šDictåº•å±‚æ˜¯åŸºäºæ•°ç»„ã€é“¾è¡¨çš„Hashè¡¨ï¼Œæ•°ç»„ä¸­ä¿å­˜çš„æ˜¯ä¸€ä¸ªä¸ªentryé”®å€¼å¯¹ï¼Œé”®å€¼å¯¹çš„ç±»å‹å¤§å¤šæ˜¯æŒ‡é’ˆï¼ŒæŒ‡å‘SDSå¯¹è±¡ã€‚æ•°ç»„ä¸­çš„entryé”®å€¼å¯¹ç”±nextæŒ‡é’ˆè¿æ¥ï¼Œä¾¿äºå¯»å€ã€‚")]),t._v(" "),s("h3",{attrs:{id:"_2-4-ziplist"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-ziplist"}},[t._v("#")]),t._v(" 2.4 ZipList")]),t._v(" "),s("p",[t._v("å‹ç¼©é“¾è¡¨ï¼Œä¸ºäº†èŠ‚çœå†…å­˜è€Œè®¾è®¡çš„é“¾è¡¨ï¼Œç”±ä¸€ç³»åˆ—ç‰¹æ®Šç¼–ç çš„"),s("code",[t._v("è¿ç»­ç©ºé—´")]),t._v("ç»„æˆï¼Œå¯ä»¥åœ¨ä»»æ„ä¸€ç«¯è¿›è¡Œå‹å…¥/å¼¹å‡ºæ“ä½œï¼Œå¹¶ä¸”è¯¥æ“ä½œçš„æ—¶é—´å¤æ‚åº¦ä¸º "),s("code",[t._v("O(1)")]),t._v("ã€‚")]),t._v(" "),s("p",[t._v("ä½†æ˜¯æˆä¹Ÿè¿ç»­ï¼Œè´¥ä¹Ÿè¿ç»­ï¼ŒZipListçš„è¯ç”Ÿæ˜¯ä¸ºäº†è§£å†³DictæŒ‡é’ˆè¿‡å¤šä¸”å†…å­˜ä¸è¿ç»­çš„é—®é¢˜ï¼Œä¸è¿‡äº§ç”Ÿäº†æ–°é—®é¢˜ ï¼šä¸€æ—¦æ•°æ®é‡å¤ªå¤§ï¼Œä¸Šå“ªå»æ‰¾è¿™ä¹ˆå¤šè¿ç»­çš„ç©ºé—´ï¼Ÿæ‰€ä»¥å¾ˆå¤šRedisçš„æ•°æ®ç±»å‹åªåœ¨æ•°æ®é‡å°çš„æ—¶å€™ç”¨ZipListã€‚")]),t._v(" "),s("div",{staticClass:"language-c extra-class"},[s("pre",{pre:!0,attrs:{class:"language-c"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typedef")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("struct")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ziplist")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("uint32_t")]),t._v(" albytes"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("uint32_t")]),t._v(" zltail"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("uint16_t")]),t._v(" zllen"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    entry "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("entry"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("uint8_t")]),t._v(" zlend"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" ziplist"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("ul",[s("li",[s("code",[t._v("zlbytes")]),t._v(" ï¼šæ€»å­—èŠ‚æ•°")]),t._v(" "),s("li",[s("code",[t._v("zltail")]),t._v(" ï¼šå°¾èŠ‚ç‚¹ä¸èµ·å§‹åœ°å€ä¹‹é—´çš„å­—èŠ‚æ•°")]),t._v(" "),s("li",[s("code",[t._v("zllen")]),t._v(" ï¼šentryèŠ‚ç‚¹çš„ä¸ªæ•°")]),t._v(" "),s("li",[s("code",[t._v("zlend")]),t._v(" ï¼šç»“æŸæ ‡å¿—ï¼Œ0xff")]),t._v(" "),s("li",[s("code",[t._v("entry")]),t._v(" ï¼šZipListä¸­æ‰€æœ‰èŠ‚ç‚¹ï¼Œä¸ªæ•°ã€å­—èŠ‚å¤§å°ä¸å®šã€‚")])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://typorehwf.oss-cn-chengdu.aliyuncs.com/image-20230129155533677.png",alt:"image-20230129155533677"}})]),t._v(" "),s("p",[t._v("entryå­—èŠ‚å¤§å°ä¸ç¡®å®šï¼Œé‚£éå†çš„æ—¶å€™è¯¥å¦‚ä½•éå†å‘¢ï¼Ÿæ•°ç»„ä¸­çš„å…ƒç´ å­—èŠ‚å¤§å°å›ºå®šï¼Œå¯ä»¥çŸ¥é“æ¯æ¬¡è¯»å–å‡ ä¸ªå­—èŠ‚çš„ç©ºé—´ï¼Œé“¾è¡¨ç›´æ¥ä½¿ç”¨æŒ‡é’ˆæŒ‡å‘ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œé‚£ä¹ˆentryè¯¥å¦‚ä½•éå†ï¼Ÿ")]),t._v(" "),s("p",[t._v("åªè¦åœ¨entryè¿™ä¸ªç»“æ„å†…éƒ¨è®°å½•ä¸€ä¸‹ä½¿ç”¨çš„ç©ºé—´å°±è¡Œäº†ã€‚")]),t._v(" "),s("p",[t._v("ä½†æ˜¯Entryè®°å½•çš„æ˜¯ä¸Šä¸€ä¸ªentryå ç”¨çš„å­—èŠ‚æ•°ã€‚ï¼ˆRedis7æ”¹ä¸ºæ­¤entryå­—èŠ‚æ•°ï¼‰")]),t._v(" "),s("p",[t._v("æ¯ä¸€ä¸ªentryæœ‰ä¸‰ä¸ªå­—æ®µ ï¼š")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("previous_entry_length")]),t._v(" ï¼šå‰ä¸€èŠ‚ç‚¹çš„é•¿åº¦ï¼Œ1-5ä¸ªå­—èŠ‚ã€‚")]),t._v(" "),s("li",[s("code",[t._v("encoding")]),t._v(" ï¼šæœ¬èŠ‚ç‚¹å±æ€§ï¼Œè®°å½•contentçš„æ•°æ®ç±»å‹ï¼ˆæ•´æ•°/å­—ç¬¦ä¸²ï¼‰ä»¥åŠé•¿åº¦ã€‚")]),t._v(" "),s("li",[s("code",[t._v("contents")]),t._v(" ï¼šä¿å­˜èŠ‚ç‚¹æ•°æ®ï¼Œå¯ä»¥æ˜¯å­—ç¬¦ä¸²æˆ–æ•´æ•°ã€‚")])]),t._v(" "),s("p",[t._v("åªè¦çŸ¥é“å‰ä¸€ä¸ªèŠ‚ç‚¹/æœ¬èŠ‚ç‚¹çš„å­—èŠ‚æ•°ï¼Œå°±å¯ä»¥éå†ã€‚")]),t._v(" "),s("h3",{attrs:{id:"_2-5-quicklist"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-5-quicklist"}},[t._v("#")]),t._v(" 2.5 QuickList")]),t._v(" "),s("p",[t._v("ä¸ºäº†è§£å†³ZipListçš„é—®é¢˜ï¼ŒQuickListè¯ç”Ÿäº†ã€‚")]),t._v(" "),s("p",[t._v("ZipListçš„é—®é¢˜æ˜¯ç©ºé—´è¿ç»­ï¼Œä½†æ˜¯æ‰¾ä¸åˆ°å¤ªå¤§çš„è¿ç»­ç©ºé—´ã€‚")]),t._v(" "),s("p",[t._v("ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒQuickListé‡‡ç”¨ä¸¤ç§æ–¹æ³• ï¼š")]),t._v(" "),s("ul",[s("li",[t._v("é™åˆ¶entryçš„ä¸ªæ•°åŠå¤§å°ã€‚")]),t._v(" "),s("li",[t._v("ä½¿ç”¨å¤šä¸ªZipListã€‚")])]),t._v(" "),s("p",[t._v("ä¸€ä¸ª5Mçš„æ•°æ®ï¼Œä½¿ç”¨ä¸€ä¸ªZipListå¯èƒ½æ‰¾ä¸åˆ°è¿ç»­çš„5Mç©ºé—´ï¼Œä½†å¦‚æœå¯ä»¥æ‰¾åˆ°5ä¸ªè¿ç»­çš„1Mç©ºé—´ï¼Œå°±å¯ä»¥å°†è¿™ä¸ªæ•°æ®åˆ†ä¸º5ä»½ï¼Œä½¿ç”¨5ä¸ªZipListå­˜å‚¨ã€‚")]),t._v(" "),s("p",[t._v("Redis3.2ä¹‹åå¼•å…¥çš„QuickListæ˜¯ä¸€ä¸ªåŒç«¯é“¾è¡¨ï¼Œåªä¸è¿‡æ¯ä¸€ä¸ªèŠ‚ç‚¹éƒ½æ˜¯ä¸€ä¸ªZipListã€‚")]),t._v(" "),s("p",[t._v("é™¤äº†æ§åˆ¶ZipListçš„å¤§å°ï¼ŒQuickListè¿˜å¯¹èŠ‚ç‚¹çš„ZipListè¿›è¡Œå‹ç¼©")]),t._v(" "),s("p",[t._v("QuickListNodeï¼ˆèŠ‚ç‚¹ï¼‰æºç ï¼š")]),t._v(" "),s("div",{staticClass:"language-c extra-class"},[s("pre",{pre:!0,attrs:{class:"language-c"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typedef")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("struct")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("quicklistNode")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æŒ‡å‘å‰ä¸€ä¸ªç»“ç‚¹çš„æŒ‡é’ˆ")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("struct")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("quicklistNode")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("pre"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æŒ‡å‘åä¸€ä¸ªèŠ‚ç‚¹çš„æŒ‡é’ˆ")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("struct")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("quicklistNode")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("next"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å½“å‰èŠ‚ç‚¹çš„ziplistæŒ‡é’ˆ")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("unsigned")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("char")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("zl"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å½“å‰èŠ‚ç‚¹çš„ziplistçš„å­—èŠ‚æ•°")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("unsigned")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" sz"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å½“å‰èŠ‚ç‚¹æ‰€å±çš„ziplistçš„entryä¸ªæ•°")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("unsigned")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" count"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ç¼–ç æ–¹å¼ 1.ZipList  2.lzfå‹ç¼©æ¨¡å¼")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("unsigned")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" encoding"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ˜¯å¦è¢«è§£å‹ç¼© 1è¯´æ˜è¢«è§£å‹äº†ï¼Œä»¥åè¦é‡æ–°å‹ç¼©")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("unsigned")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" recompress"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("QuickListæºç ï¼š")]),t._v(" "),s("div",{staticClass:"language-c extra-class"},[s("pre",{pre:!0,attrs:{class:"language-c"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typedef")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("struct")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("quicklist")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å¤´èŠ‚ç‚¹æŒ‡é’ˆ")]),t._v("\n    quicklistNode "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("head"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å°¾èŠ‚ç‚¹æŒ‡é’ˆ")]),t._v("\n    quicklistNode "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("tail"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ‰€æœ‰ziplistä¸­çš„entryä¸ªæ•°")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("unsigned")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("long")]),t._v(" count"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ziplistä¸ªæ•°")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("unsigned")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("long")]),t._v(" len"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ziplistçš„entryæ•°é‡ä¸Šé™")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" fill"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// é»˜è®¤ä¸º2")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),s("p",[t._v("ï¼ˆæºç åˆ äº†ä¸€ç‚¹æ²¡ç”¨çš„ï¼‰")]),t._v(" "),s("p",[t._v("å½“å­˜å‚¨ä¸€å®šæ•°æ®æ—¶ï¼ŒQuickListçš„æ¨¡æ · ï¼š")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://typorehwf.oss-cn-chengdu.aliyuncs.com/image-20230129164440634.png",alt:"image-20230129164440634"}})]),t._v(" "),s("p",[t._v("æ€»ç»“ QuickListç‰¹ç‚¹ï¼š")]),t._v(" "),s("ol",[s("li",[t._v("èŠ‚ç‚¹ä¸ºziplistçš„åŒç«¯é“¾è¡¨ã€‚")]),t._v(" "),s("li",[t._v("æ§åˆ¶ziplistä¸­entryçš„ä¸ªæ•°ä»¥åŠæ¯ä¸ªentryçš„å¤§å°ã€‚")]),t._v(" "),s("li",[t._v("ä¸­é—´èŠ‚ç‚¹å¯ä»¥å‹ç¼©ï¼Œè¿›ä¸€æ­¥èŠ‚çœå†…å­˜ã€‚")])]),t._v(" "),s("h3",{attrs:{id:"_2-6-skiplist"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-6-skiplist"}},[t._v("#")]),t._v(" 2.6 "),s("code",[t._v("SkipList")])]),t._v(" "),s("p",[t._v("SkipListï¼Œé¢è¯•ä¸­ç»å¸¸é—®çš„è·³è¡¨ï¼Œè¢«ç§°ä¸ºè·³è¡¨æ˜¯å› ä¸ºå®ƒéå†çš„æ—¶å€™å¯ä»¥â€œè·³â€ç€éå†ã€‚")]),t._v(" "),s("p",[t._v("å¯¹äºä¸€ä¸ªæœ‰åºæ•°ç»„ï¼Œå¯ä»¥ä½¿ç”¨äºŒåˆ†æ³•å¿«é€ŸæŸ¥æ‰¾ï¼Œä½†æ˜¯é“¾è¡¨æ€ä¹ˆå¿«é€Ÿå‘¢ï¼Ÿ")]),t._v(" "),s("p",[t._v("æ­£å¸¸çš„é“¾è¡¨åªæœ‰æŒ‡å‘å‰åèŠ‚ç‚¹çš„æŒ‡é’ˆï¼Œä½†æ˜¯è·³è¡¨ä¸ä¸€æ ·ï¼Œå®ƒæœ‰"),s("code",[t._v("éšæœºä¸ªéšæœºæŒ‡é’ˆ")]),t._v("ã€‚å¯¹äº1-10è¿™å‡ ä¸ªæ•°ç»„æˆçš„è·³è¡¨ï¼Œå¯èƒ½1è¿™ä¸ªå…ƒç´ ä¸­æœ‰æŒ‡å‘5ã€6ã€9ã€10çš„æŒ‡é’ˆï¼Œ2æœ‰æŒ‡å‘3ã€4ã€8ã€10çš„ï¼Œ10å¯èƒ½æœ‰æŒ‡å‘1ã€4ã€7çš„æŒ‡é’ˆã€‚è¿™æ ·å°±å¯ä»¥"),s("code",[t._v("é€šè¿‡ä¸æ–­çš„è·³è·ƒã€æ¯”è¾ƒ")]),t._v("ï¼Œå¿«é€Ÿå¾—åˆ°æƒ³è¦çš„å€¼ã€‚æ­¤ç»“æ„æ­£å› ä¸ºè¿™ä¸ªç‰¹ç‚¹è¢«ç§°ä¸ºè·³è¡¨ã€‚")]),t._v(" "),s("p",[t._v("å½“ç„¶äº†ï¼Œè·³è¡¨çš„æŒ‡é’ˆæ˜¯éšæœºç”Ÿæˆçš„ï¼Œéšæœºæ€§å¤ªå¤§ï¼Œå¯èƒ½ä¸€æ¬¡å°±æ‰¾åˆ°å€¼ï¼Œå¯èƒ½éœ€è¦ä¸€ä¸ªä¸€ä¸ªéå†ã€‚")]),t._v(" "),s("p",[t._v("SkipListï¼ˆè·³è¡¨ï¼‰é¦–å…ˆæ˜¯é“¾è¡¨ï¼Œä½†ä¸ä¼ ç»Ÿé“¾è¡¨æœ‰å‡ ç‚¹å·®å¼‚ ï¼š")]),t._v(" "),s("ul",[s("li",[t._v("å…ƒç´ å‡åºæ’åˆ—ï¼Œä¸è¿‡ä¸æ˜¯æŒ‰ç…§å…ƒç´ è¿›è¡Œæ’åºï¼Œè€Œæ˜¯æ ¹æ®å…ƒç´ ç”Ÿæˆçš„scoreæ’åºã€‚")]),t._v(" "),s("li",[t._v("èŠ‚ç‚¹å¯èƒ½åŒ…å«å¤šä¸ªæŒ‡é’ˆï¼ŒæŒ‡é’ˆè·¨åº¦éšæœºã€‚")])]),t._v(" "),s("p",[t._v("æ­£å› ä¸ºè¿™ä¸¤ä¸ªç‰¹ç‚¹ï¼Œè·³è¡¨å¯ä»¥è¾¹è·³è·ƒè¾¹æ¯”è¾ƒï¼Œå¤§å¤§æé«˜æŸ¥è¯¢æ•ˆç‡ã€‚")]),t._v(" "),s("p",[t._v("è·³è¡¨èŠ‚ç‚¹")]),t._v(" "),s("div",{staticClass:"language-c extra-class"},[s("pre",{pre:!0,attrs:{class:"language-c"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typedef")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("struct")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("zskiplistNode")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    sds ele"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("double")]),t._v(" score"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    zskiplistNode "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("backward"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("struct")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("zskiplistLevel")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        zskiplistNode "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("forward"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("unsigned")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("long")]),t._v(" span"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" level"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("zskiplistNode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("ul",[s("li",[s("code",[t._v("ele")]),t._v(" ï¼šèŠ‚ç‚¹å­˜å‚¨çš„å€¼ã€‚")]),t._v(" "),s("li",[s("code",[t._v("score")]),t._v(" ï¼šèŠ‚ç‚¹çš„åˆ†æ•°ï¼Œç”¨äºæ’åºã€‚")]),t._v(" "),s("li",[s("code",[t._v("backward")]),t._v(" ï¼šå‰ä¸€ä¸ªèŠ‚ç‚¹çš„æŒ‡é’ˆã€‚")]),t._v(" "),s("li",[s("code",[t._v("level")]),t._v(" ï¼šå¤šçº§ç´¢å¼•æ•°ç»„ï¼Œæ‰€æœ‰åç»§èŠ‚ç‚¹")]),t._v(" "),s("li",[s("code",[t._v("forward")]),t._v(" ï¼šä¸€ä¸ªèŠ‚ç‚¹å¯èƒ½æœ‰å¤šä¸ªlevelï¼ŒforwardæŒ‡å‘è¿™ä¸ªlevelä»£è¡¨çš„èŠ‚ç‚¹ã€‚")]),t._v(" "),s("li",[s("code",[t._v("span")]),t._v(" ï¼šç´¢å¼•è·¨åº¦ï¼Œç¬¬ä¸€ä¸ªèŠ‚ç‚¹æŒ‡å‘ç¬¬åä¸ªèŠ‚ç‚¹ï¼Œè·¨åº¦ä¸º9")])]),t._v(" "),s("p",[t._v("è·³è¡¨")]),t._v(" "),s("div",{staticClass:"language-c extra-class"},[s("pre",{pre:!0,attrs:{class:"language-c"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typedef")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("struct")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("zskiplist")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("struct")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("zskiplistNode")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("header"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("tail"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("unsigned")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("long")]),t._v(" length"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" level"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("ul",[s("li",[s("code",[t._v("header tail")]),t._v(" ï¼šå¤´èŠ‚ç‚¹ã€å°¾èŠ‚ç‚¹ã€‚")]),t._v(" "),s("li",[s("code",[t._v("length")]),t._v(" ï¼šèŠ‚ç‚¹æ•°é‡ã€‚")]),t._v(" "),s("li",[s("code",[t._v("level")]),t._v(" ï¼šæœ€å¤§ç´¢å¼•å±‚çº§ï¼Œé»˜è®¤ä¸º1ï¼Œæœ€å¤§ä¸º32ï¼Œå³ä¸€ä¸ªèŠ‚ç‚¹çš„åç»§æŒ‡é’ˆå¯ä»¥æœ‰1-32ä¸ªã€‚")])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://typorehwf.oss-cn-chengdu.aliyuncs.com/image-20230129230812411.png",alt:"image-20230129230812411"}})]),t._v(" "),s("p",[t._v("SkipListç‰¹ç‚¹ï¼š")]),t._v(" "),s("ol",[s("li",[t._v("åŒå‘é“¾è¡¨ï¼Œæ¯ä¸ªèŠ‚ç‚¹åŒ…å«scoreå’Œeleå€¼")]),t._v(" "),s("li",[t._v("èŠ‚ç‚¹æŒ‰ç…§scoreæ’åºï¼Œscoreå€¼ä¸€æ ·åˆ™æŒ‰ç…§eleæ’åº")]),t._v(" "),s("li",[t._v("æ¯ä¸ªèŠ‚ç‚¹éƒ½å¯ä»¥åŒ…å«å¤šå±‚æŒ‡é’ˆï¼Œå±‚æ•°æ˜¯1-32çš„éšæœºå€¼")]),t._v(" "),s("li",[t._v("ä¸åŒæŒ‡é’ˆåˆ°ä¸‹ä¸€ä¸ªèŠ‚ç‚¹çš„è·¨åº¦ä¸åŒï¼Œå±‚çº§è¶Šé«˜ï¼Œè·¨åº¦è¶Šå¤§ã€‚")]),t._v(" "),s("li",[t._v("å¢åˆ æ”¹æŸ¥æ•ˆç‡ä¸çº¢é»‘æ ‘åŸºæœ¬ä¸€è‡´ï¼Œå®ç°å´æ›´ç®€å•ã€‚")])]),t._v(" "),s("h2",{attrs:{id:"_3-redisobject"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-redisobject"}},[t._v("#")]),t._v(" 3. RedisObject")]),t._v(" "),s("p",[t._v("å­¦ä¹ äº†ä»¥ä¸Šå‡ ç§æ•°æ®ç±»å‹ï¼Œæœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿå¯¹ï¼Œç»„æˆRedisä¸­å¯ä»¥ä½¿ç”¨çš„æ•°æ®ç»“æ„ï¼Œé‚£ä¹ˆå„ä¸ªæ•°æ®ç»“æ„ç”¨ä»€ä¹ˆæ ·çš„åº•å±‚å®ç°å‘¢ï¼Ÿåœ¨å“ªé‡Œå¯ä»¥çœ‹åˆ°å‘¢ï¼Ÿåœ¨å“ªé‡Œè®°å½•ä¸‹æ¥å‘¢ï¼Ÿ")]),t._v(" "),s("p",[s("code",[t._v("RedisObject")])]),t._v(" "),s("p",[t._v("Redisä¸­çš„ä»»ä½•æ•°æ®ç±»å‹éƒ½ä¼šè¢«å°è£…ä¸ºä¸€ä¸ªRedisObjectï¼Œä¹Ÿå«åšRediså¯¹è±¡ã€‚")]),t._v(" "),s("div",{staticClass:"language-c extra-class"},[s("pre",{pre:!0,attrs:{class:"language-c"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typedef")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("struct")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("redisObject")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("unsigned")]),t._v(" type"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("unsigned")]),t._v(" encoding"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("unsigned")]),t._v(" lru"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("24")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" refcount"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("ptr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("ul",[s("li",[s("p",[s("code",[t._v("type")]),t._v(" ï¼šæ­¤å¯¹è±¡çš„ç±»å‹ï¼Œåˆ†åˆ«ä¸ºstringã€listã€setã€zsetã€hash")])]),t._v(" "),s("li",[s("p",[s("code",[t._v("encoding")]),t._v(" ï¼šæ­¤å¯¹è±¡çš„åº•å±‚å®ç°ï¼Œä¸Šè¿°SDSã€Intsetã€Dictã€SkipList...æœ‰11ä¸ªå€¼ã€‚")])]),t._v(" "),s("li",[s("p",[s("code",[t._v("lru")]),t._v(" ï¼šè®°å½•å½“å‰Rediså¯¹è±¡æœ€è¿‘ä¸€æ¬¡è®¿é—®æ—¶é—´ï¼Œä»¥ä¾¿å°†é•¿æ—¶é—´æœªä½¿ç”¨çš„å¯¹è±¡å›æ”¶ã€‚")])]),t._v(" "),s("li",[s("p",[s("code",[t._v("refcount")]),t._v(" ï¼šå¯¹è±¡å¼•ç”¨è®¡æ•°å™¨ï¼Œè®¡æ•°å™¨ä¸º0åˆ™è¯´æ˜å¯¹è±¡æ— äººä½¿ç”¨ï¼Œå¯ä»¥è¢«å›æ”¶ã€‚")])]),t._v(" "),s("li",[s("p",[s("code",[t._v("*ptr")]),t._v(" ï¼šæŒ‡å‘å…·ä½“å­˜æ”¾æ•°æ®çš„ç©ºé—´ã€‚")])])]),t._v(" "),s("p",[t._v("typeå’Œencodingå­—æ®µæ˜¯æœ¬ç¯‡æ–‡ç« å…³æ³¨çš„åœ°æ–¹ã€‚")]),t._v(" "),s("p",[t._v("å…ˆæ¥çœ‹çœ‹encodingå­—æ®µçš„11ä¸ªå€¼ ï¼š")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("ç¼–å·")]),t._v(" "),s("th",[t._v("ç¼–ç æ–¹å¼")]),t._v(" "),s("th",[t._v("è¯´æ˜")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("0")]),t._v(" "),s("td",[t._v("OBJ_ENCODING_"),s("code",[t._v("INT")])]),t._v(" "),s("td",[t._v("longç±»å‹çš„æ•´æ•°å­—ç¬¦ä¸²")])]),t._v(" "),s("tr",[s("td",[t._v("1")]),t._v(" "),s("td",[t._v("OBJ_ENCODING_"),s("code",[t._v("RAW")])]),t._v(" "),s("td",[t._v("rawç¼–ç çš„åŠ¨æ€å­—ç¬¦ä¸²")])]),t._v(" "),s("tr",[s("td",[t._v("2")]),t._v(" "),s("td",[t._v("OBJ_ENCODING_"),s("code",[t._v("EMBSTR")])]),t._v(" "),s("td",[t._v("embstrç¼–ç çš„åŠ¨æ€å­—ç¬¦ä¸²")])]),t._v(" "),s("tr",[s("td",[t._v("3")]),t._v(" "),s("td",[t._v("OBJ_ENCODING_"),s("code",[t._v("INTSET")])]),t._v(" "),s("td",[t._v("æ•´æ•°é›†åˆ")])]),t._v(" "),s("tr",[s("td",[t._v("4")]),t._v(" "),s("td",[t._v("OBJ_ENCODING_"),s("code",[t._v("ZIPLIST")])]),t._v(" "),s("td",[t._v("å‹ç¼©åˆ—è¡¨")])]),t._v(" "),s("tr",[s("td",[t._v("5")]),t._v(" "),s("td",[t._v("OBJ_ENCODING_"),s("code",[t._v("QUICKLIST")])]),t._v(" "),s("td",[t._v("å¿«é€Ÿåˆ—è¡¨")])]),t._v(" "),s("tr",[s("td",[t._v("6")]),t._v(" "),s("td",[t._v("OBJ_ENCODING_"),s("code",[t._v("SKIPLIST")])]),t._v(" "),s("td",[t._v("è·³è¡¨")])]),t._v(" "),s("tr",[s("td",[t._v("7")]),t._v(" "),s("td",[t._v("OBJ_ENCODING_"),s("code",[t._v("LINKEDLIST")])]),t._v(" "),s("td",[t._v("åŒç«¯é“¾è¡¨")])]),t._v(" "),s("tr",[s("td",[t._v("8")]),t._v(" "),s("td",[t._v("OBJ_ENCODING_"),s("code",[t._v("HT")])]),t._v(" "),s("td",[t._v("å­—å…¸")])]),t._v(" "),s("tr",[s("td",[t._v("9")]),t._v(" "),s("td",[t._v("OBJ_ENCODING_"),s("code",[t._v("ZIPMAP")])]),t._v(" "),s("td",[t._v("å·²åºŸå¼ƒ")])]),t._v(" "),s("tr",[s("td",[t._v("10")]),t._v(" "),s("td",[t._v("OBJ_ENCODING_"),s("code",[t._v("STREAM")])]),t._v(" "),s("td",[t._v("Streamæµ")])])])]),t._v(" "),s("p",[t._v("å¯ä»¥çœ‹åˆ°ï¼Œstringæœ‰ä¸‰ç§ç¼–ç æ–¹å¼ï¼Œlistæœ‰3ä¸­ç¼–ç æ–¹å¼ï¼Œsetæœ‰ä¸‰ç§ç¼–ç æ–¹å¼ã€‚")]),t._v(" "),s("img",{staticStyle:{zoom:"67%"},attrs:{src:"https://typorehwf.oss-cn-chengdu.aliyuncs.com/image-20230128213044917.png",alt:"image-20230128213044917"}}),t._v(" "),s("hr"),t._v(" "),s("h2",{attrs:{id:"_4-æ•°æ®ç»“æ„"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-æ•°æ®ç»“æ„"}},[t._v("#")]),t._v(" 4. æ•°æ®ç»“æ„")]),t._v(" "),s("h3",{attrs:{id:"_4-1-string"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-string"}},[t._v("#")]),t._v(" 4.1 string")]),t._v(" "),s("p",[t._v("stringæ˜¯Redisæœ€å¸¸è§çš„æ•°æ®å­˜å‚¨ç±»å‹ã€‚")]),t._v(" "),s("ul",[s("li",[t._v("å¦‚æœå­˜å‚¨çš„å­—ç¬¦ä¸²é•¿åº¦å°äº44å­—èŠ‚ï¼Œåˆ™ä¼šä½¿ç”¨EMBSTRç¼–ç ã€‚æ­¤æ—¶"),s("code",[t._v("object headä¸SDSæ˜¯ä¸€ç‰‡è¿ç»­ç©ºé—´")]),t._v("ï¼Œç”³è¯·å†…å­˜æ—¶åªéœ€è¦è°ƒç”¨ä¸€æ¬¡å†…å­˜å†…å­˜åˆ†é…å‡½æ•°ï¼Œæ•ˆç‡æ›´é«˜ã€‚")])]),t._v(" "),s("img",{staticStyle:{zoom:"67%"},attrs:{src:"https://typorehwf.oss-cn-chengdu.aliyuncs.com/image-20230130113634586.png",alt:"image-20230130113634586"}}),t._v(" "),s("ul",[s("li",[t._v("SDSé•¿åº¦å¤§äº44ï¼Œç¼–ç æ–¹å¼æ˜¯RAWã€‚object headä¸SDSä¸å†è¿ç»­")])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://typorehwf.oss-cn-chengdu.aliyuncs.com/image-20230130113114911.png",alt:"image-20230130113114911"}})]),t._v(" "),s("ul",[s("li",[t._v("å¦‚æœSDSçš„å†…å®¹æ˜¯æ•°å­—ï¼Œå¹¶ä¸”è¿™ä¸ªæ•°å­—åœ¨Long_MAXèŒƒå›´å†…å°±ä½¿ç”¨INTç¼–ç æ–¹å¼ã€‚INTç¼–ç æ–¹å¼ç›´æ¥å°†æ•°æ®å­˜åœ¨RedisObjectçš„ptræŒ‡é’ˆä½ç½®ï¼ˆåˆšå¥½8å­—èŠ‚ï¼‰ï¼Œä¸éœ€è¦SDSäº†ã€‚")])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://typorehwf.oss-cn-chengdu.aliyuncs.com/image-20230128221749947.png",alt:"image-20230128221749947"}})]),t._v(" "),s("p",[t._v("å¯ä»¥çœ‹å‡ºæ˜æ˜¾åŒºåˆ« ï¼šEMBSTRçš„ç©ºé—´æ˜¯è¿ç»­çš„ï¼Œå› ä¸ºå­—ç¬¦ä¸²ä½“ç§¯å°ï¼Œå®¹æ˜“ç”³è¯·è¿ç»­ç©ºé—´ã€‚")]),t._v(" "),s("p",[t._v("ä»¥ä¸‹å‘Rediså­˜å‚¨å››ä¸ªå€¼ï¼Œåˆ†åˆ«ä¸º æ•°å­—ã€çŸ­å­—ç¬¦ä¸²ã€44ä½å­—ç¬¦ä¸²ã€45ä½å­—ç¬¦ä¸²ï¼ŒæŸ¥çœ‹çš„ç¼–ç æ–¹å¼ç»“æœå¦‚ä¸‹ï¼š")]),t._v(" "),s("div",{staticClass:"language-she extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('yun:0>set a 12\n"OK"\nyun:0>object encoding a\n"int"\nyun:0>set b xiaoming\n"OK"\nyun:0>object encoding b\n"embstr"\nyun:0>set c 01234567890123456789012345678901234567890123\n"OK"\nyun:0>object encoding c\n"embstr"\nyun:0>set d 012345678901234567890123456789012345678901234\n"OK"\nyun:0>object encoding d\n"raw"\n')])])]),s("h3",{attrs:{id:"_4-2-list"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-list"}},[t._v("#")]),t._v(" 4.2 list")]),t._v(" "),s("p",[t._v("listæ‹¥æœ‰ä¸‰ç§ç¼–ç æ–¹å¼ ï¼šlinkedlistã€ziplistã€quicklistã€‚è‡ªä»QuickListå‡ºç°åå°±å¾ˆå°‘ç”¨LinkedListäº†ã€‚")]),t._v(" "),s("p",[t._v("æ‰€ä»¥åœ¨Redis3.2ç‰ˆæœ¬åï¼ŒRedisç»Ÿä¸€é‡‡ç”¨QuickListå®ç°Listã€‚")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://typorehwf.oss-cn-chengdu.aliyuncs.com/image-20230130095118130.png",alt:"image-20230130095118130"}})]),t._v(" "),s("h3",{attrs:{id:"_4-3-set"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-set"}},[t._v("#")]),t._v(" 4.3 set")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("å½“å­˜å‚¨çš„æ•°æ®å…¨éƒ¨ä¸ºæ•´æ•°ï¼Œä¸”å…ƒç´ æ•°é‡ä¸è¶…è¿‡set-max-intset-emtriesæ—¶ï¼Œsetä½¿ç”¨intsetç¼–ç ")])]),t._v(" "),s("li",[s("p",[t._v("å…¶ä»–æƒ…å†µä½¿ç”¨Dictç¼–ç ï¼Œä½¿ç”¨å®ƒçš„keyï¼Œvalueç»Ÿä¸€ä¸ºnullã€‚")])])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://typorehwf.oss-cn-chengdu.aliyuncs.com/image-20230130100836039.png",alt:"image-20230130100836039"}})]),t._v(" "),s("h3",{attrs:{id:"_4-4-zset"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-4-zset"}},[t._v("#")]),t._v(" 4.4 zset")]),t._v(" "),s("p",[t._v("zsetä¹Ÿå°±æ˜¯sortedsetï¼Œæ¯ä¸€ä¸ªå…ƒç´ éƒ½æœ‰ä¸€ä¸ªç”¨äºæ’åºçš„scoreå€¼ã€‚zsetçš„ç‰¹ç‚¹ ï¼š")]),t._v(" "),s("ul",[s("li",[t._v("scoreå€¼ç”¨äºæ’åº")]),t._v(" "),s("li",[t._v("é”®å”¯ä¸€")]),t._v(" "),s("li",[t._v("å¯ä»¥æ ¹æ®é”®æŸ¥è¯¢åˆ†æ•°")])]),t._v(" "),s("p",[t._v("çœ‹èµ·æ¥å¯ä»¥ç”¨SkipListï¼Œä½†æ˜¯è·³è¡¨çš„é”®ä¸å”¯ä¸€ï¼Œè€Œä¸”å®ƒçš„scoreè™½ç„¶å¯ä»¥æ’åºï¼Œä½†æ— æ³•æŸ¥è¯¢ã€‚")]),t._v(" "),s("p",[t._v("çœ‹èµ·æ¥å¯ä»¥ç”¨Dictï¼Œä½†Dictæ— æ³•æ’åºã€‚")]),t._v(" "),s("p",[t._v("é‚£ä¹ˆæˆ‘ä»¬å°†å®ƒä»¬ç»“åˆèµ·æ¥ä¸å°±è¡Œäº†ï¼Ÿä¸€ä¸ªzsetåŒ…å«ä¸€ä¸ªSkipListå’Œä¸€ä¸ªDictï¼Œæ·»åŠ å…ƒç´ æ—¶å…ˆå‘Dictæ·»åŠ ï¼Œä¿è¯å…ƒç´ å”¯ä¸€ï¼Œå¦‚æœå…ƒç´ å”¯ä¸€å†å‘SkipListæ·»åŠ ï¼Œä¿è¯å¯æ’åºã€‚")]),t._v(" "),s("div",{staticClass:"language-c extra-class"},[s("pre",{pre:!0,attrs:{class:"language-c"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typedef")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("struct")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("zset")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    dict "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("dict"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    zskiplist "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("zsl"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("è™½ç„¶zsetä½¿ç”¨äº†ä¸¤ç§ç»“æ„ï¼Œä½†å®ƒçš„ç¼–ç å†™æˆskiplistã€‚")]),t._v(" "),s("p",[t._v("ä½†æ˜¯å½“å…ƒç´ æ•°é‡å°äº128æˆ–å…ƒç´ å¤§å°å°äº64å­—èŠ‚æ—¶ï¼Œzsetä¼šä½¿ç”¨ZipListèŠ‚çœç©ºé—´ã€‚")]),t._v(" "),s("ul",[s("li",[t._v("å…ƒç´ æ•°é‡å°äº128æˆ–å…ƒç´ å¤§å°å°äº64å­—èŠ‚æ—¶ï¼Œä½¿ç”¨ZipListèŠ‚çœç©ºé—´ã€‚")]),t._v(" "),s("li",[t._v("å…¶ä»–æƒ…å†µä½¿ç”¨ Dict + SkipListã€‚")])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://typorehwf.oss-cn-chengdu.aliyuncs.com/image-20230130102429885.png",alt:"image-20230130102429885"}})]),t._v(" "),s("h3",{attrs:{id:"_4-5-hash"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-5-hash"}},[t._v("#")]),t._v(" 4.5 hash")]),t._v(" "),s("p",[t._v("Hashç»“æ„ä¸Redisä¸­çš„Zsetå¾ˆåƒ")]),t._v(" "),s("ul",[s("li",[t._v("é”®å€¼å­˜å‚¨")]),t._v(" "),s("li",[t._v("å¯ä»¥æ ¹æ®é”®è·å–å€¼")]),t._v(" "),s("li",[t._v("é”®å”¯ä¸€")])]),t._v(" "),s("p",[t._v("äºŒè€…å·®åˆ«ä¾‹å¦‚zsetçš„å€¼å¿…é¡»æ˜¯æ•°å­—ï¼Œç”¨äºæ’åºã€‚è€ŒHashç»“æ„ä¸ç”¨æ’åºã€‚")]),t._v(" "),s("p",[t._v("Hashåº•å±‚é‡‡ç”¨çš„ç¼–ç ä¸ZsetåŸºæœ¬ä¸€è‡´ï¼Œåªéœ€è¦æŠŠæ’åºæœ‰å…³çš„SkipListå»æ‰å³å¯ ï¼š")]),t._v(" "),s("ul",[s("li",[t._v("Hashé»˜è®¤ä½¿ç”¨ZipListç¼–ç ï¼Œä»¥èŠ‚çœå†…å­˜ã€‚ZipListçš„ç›¸é‚»ä¸¤ä¸ªentryåˆ†åˆ«å­˜å‚¨é”®ã€å€¼ã€‚")]),t._v(" "),s("li",[t._v("å½“å…ƒç´ æ•°é‡è¶…è¿‡512æˆ–ä»»æ„ä¸€ä¸ªentryèŠ‚ç‚¹å¤§å°è¶…è¿‡64å­—èŠ‚æ—¶Hashç»“æ„ä¼šè½¬ä¸ºHTç¼–ç ï¼Œä¹Ÿå°±æ˜¯Dictã€‚")])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://typorehwf.oss-cn-chengdu.aliyuncs.com/image-20230130095246270.png",alt:"image-20230130095246270"}})]),t._v(" "),s("h3",{attrs:{id:"_4-6-æ€»ç»“"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-6-æ€»ç»“"}},[t._v("#")]),t._v(" 4.6 æ€»ç»“")]),t._v(" "),s("img",{staticStyle:{zoom:"67%"},attrs:{src:"https://typorehwf.oss-cn-chengdu.aliyuncs.com/image-20230130113903956.png",alt:"image-20230130113903956"}}),t._v(" "),s("h2",{attrs:{id:"_5-åº”ç”¨åœºæ™¯"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-åº”ç”¨åœºæ™¯"}},[t._v("#")]),t._v(" 5. åº”ç”¨åœºæ™¯")]),t._v(" "),s("h3",{attrs:{id:"_5-1-string"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-string"}},[t._v("#")]),t._v(" 5.1 string")]),t._v(" "),s("ol",[s("li",[t._v("ç”¨äºåš"),s("code",[t._v("ç¼“å­˜")])]),t._v(" "),s("li",[t._v("setnx æ“ä½œç”Ÿæˆ"),s("code",[t._v("åˆ†å¸ƒå¼é”")])]),t._v(" "),s("li",[t._v("è¿™æ—¶å¯ä»¥ç”¨äº"),s("code",[t._v("è®¡æ•°å™¨")]),t._v("ã€‚å½“æ•°æ®æ˜¯æ•°å­—æ—¶ï¼Œstringä¸ä¼šåˆ›å»ºæ–°çš„SDSå¯¹è±¡ï¼Œè€Œæ˜¯å°†æ•°å­—å­˜å‚¨åœ¨RedisObjectçš„pträ¸Šï¼Œéå¸¸èŠ‚çœç©ºé—´ã€‚")])]),t._v(" "),s("p",[t._v("ç”¨äºè®¡æ•°å™¨ä¸”å¹¶å‘é‡é«˜çš„æƒ…å†µä¸‹ï¼Œå‡å¦‚ç”¨äºæ–‡ç« æµè§ˆé‡ï¼Œä½ çš„æœåŠ¡æ‹†åˆ†ä¸º10å°æœºå™¨ï¼Œè¿™10å°æœºå™¨å¯èƒ½åŒæ—¶æŠ¢å¤ºæµè§ˆé‡ä¸º100çš„è¿™ä¸ªæ•°å­—ï¼Œé‚£ä¹ˆåªæœ‰ä¸€å°æœºå™¨å¯ä»¥æˆåŠŸï¼Œå‰©ä¸‹9å°éƒ½ä¼šå¤±è´¥ï¼Œæ•ˆç‡å¤ªä½ã€‚æ­¤æ—¶æˆ‘ä»¬å¯ä»¥ä½¿ç”¨"),s("code",[t._v("INCRBY")]),t._v("ï¼Œä¸€å°æœºå™¨è¿‡æ¥ï¼Œæˆ‘ä»¬ç»™å®ƒ100ä¸ªæµè§ˆé‡ï¼Œå®ƒè‡ªå·±ç”¨å»å§ï¼ŒRedisä¸­çš„æ•°æ®ç›´æ¥INCRBY 100å³å¯ã€‚è¿™æ ·å°±å¯ä»¥æé«˜æ•ˆç‡ã€‚")]),t._v(" "),s("h3",{attrs:{id:"_5-2-list"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-list"}},[t._v("#")]),t._v(" 5.2 list")]),t._v(" "),s("p",[t._v("listæ”¯æŒåŒç«¯æ’å…¥ã€è®¿é—®")]),t._v(" "),s("p",[t._v("ç”¨ä½œä¿¡æ¯æµã€‚ä¾‹å¦‚ä½ å…³æ³¨å¾ˆå¤šå…¬ä¼—å·ï¼Œè¿™äº›å…¬ä¼—å·å‘çš„æ–‡ç« éƒ½å¯ä»¥å¡è¿›ä½ çš„listä¸­")]),t._v(" "),s("h3",{attrs:{id:"_5-3-set"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-3-set"}},[t._v("#")]),t._v(" 5.3 set")]),t._v(" "),s("p",[t._v("å¾ˆå¤šäººç”¨setçš„åŸå› ä¼°è®¡å°±æ˜¯å€¼å”¯ä¸€å§ï¼Œè¿™ä¸ªå°±å¯ä»¥ç”¨ä½œç‚¹èµåˆ—è¡¨ã€å¥½å‹åˆ—è¡¨ã€å…³æ³¨åˆ—è¡¨ã€æ”¶è—ç­‰ç­‰..")]),t._v(" "),s("p",[t._v("åŒæ—¶å®ƒå¯ä»¥æ±‚äº¤é›†ã€å¹¶é›†ï¼Œè¿™æ ·å°±æ”¯æŒâ€œå…±åŒå¥½å‹â€ã€â€œä½ å¯èƒ½è®¤è¯†çš„äººâ€ç­‰ç­‰æ“ä½œ")]),t._v(" "),s("h3",{attrs:{id:"_5-4-zset"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-4-zset"}},[t._v("#")]),t._v(" 5.4 zset")]),t._v(" "),s("p",[t._v("zsetå¯ä»¥æ ¹æ®scoreæ’åºï¼ŒåŒæ—¶ä¿è¯å€¼å”¯ä¸€ã€‚å¸¸ç”¨äºæ’è¡Œæ¦œã€‚")]),t._v(" "),s("h3",{attrs:{id:"_5-5-hash"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-5-hash"}},[t._v("#")]),t._v(" 5.5 hash")]),t._v(" "),s("p",[t._v("å¯ç”¨äºè´­ç‰©è½¦ï¼Œhashçš„æ“ä½œå¾ˆå¥‘åˆâ€œè´­ç‰©è½¦â€è¿™ä¸€åŠŸèƒ½éœ€æ±‚ ï¼šå¢åŠ åˆ é™¤å•†å“ã€å¢åŠ å‡å°æŸä¸ªå•†å“çš„æ•°é‡ã€é€‰ä¸­å…¨éƒ¨ã€è·å–å…¨éƒ¨å•†å“çš„æ•°é‡....")])])}),[],!1,null,null,null);s.default=n.exports}}]);