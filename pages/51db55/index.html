<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>2. Sentinel è´£ä»»é“¾æµç¨‹</title>
    <meta name="generator" content="VuePress 1.9.2">
    <link rel="icon" href="/img/favicon.ico">
    <meta name="description" content="ä¸€ä¸ªåŸºäºVuePressçš„ çŸ¥è¯†ç®¡ç†&amp;åšå®¢ ä¸»é¢˜">
    <meta name="keywords" content="vuepress,theme,blog,vdoing">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/assets/css/0.styles.be1758fe.css" as="style"><link rel="preload" href="/assets/js/app.55b11924.js" as="script"><link rel="preload" href="/assets/js/2.73d4029d.js" as="script"><link rel="preload" href="/assets/js/64.63e35c1a.js" as="script"><link rel="prefetch" href="/assets/js/10.2b19092b.js"><link rel="prefetch" href="/assets/js/11.5d2d3328.js"><link rel="prefetch" href="/assets/js/12.758d1773.js"><link rel="prefetch" href="/assets/js/13.83080798.js"><link rel="prefetch" href="/assets/js/14.cad064bf.js"><link rel="prefetch" href="/assets/js/15.ce67be64.js"><link rel="prefetch" href="/assets/js/16.7c331707.js"><link rel="prefetch" href="/assets/js/17.353aa3a5.js"><link rel="prefetch" href="/assets/js/18.812e388f.js"><link rel="prefetch" href="/assets/js/19.bea0f1aa.js"><link rel="prefetch" href="/assets/js/20.ae2220ed.js"><link rel="prefetch" href="/assets/js/21.8b82ed1e.js"><link rel="prefetch" href="/assets/js/22.97d63dbe.js"><link rel="prefetch" href="/assets/js/23.79033cfd.js"><link rel="prefetch" href="/assets/js/24.96ca227f.js"><link rel="prefetch" href="/assets/js/25.90813872.js"><link rel="prefetch" href="/assets/js/26.b18aba27.js"><link rel="prefetch" href="/assets/js/27.f9995d4b.js"><link rel="prefetch" href="/assets/js/28.31b6825c.js"><link rel="prefetch" href="/assets/js/29.94237f71.js"><link rel="prefetch" href="/assets/js/3.ceab01f3.js"><link rel="prefetch" href="/assets/js/30.8269ef59.js"><link rel="prefetch" href="/assets/js/31.c18e7c44.js"><link rel="prefetch" href="/assets/js/32.06171ecb.js"><link rel="prefetch" href="/assets/js/33.a33f1b11.js"><link rel="prefetch" href="/assets/js/34.3e39f435.js"><link rel="prefetch" href="/assets/js/35.6d245714.js"><link rel="prefetch" href="/assets/js/36.c4063459.js"><link rel="prefetch" href="/assets/js/37.5bbb13b5.js"><link rel="prefetch" href="/assets/js/38.924e8c19.js"><link rel="prefetch" href="/assets/js/39.e99c2fc3.js"><link rel="prefetch" href="/assets/js/4.a6d97bd6.js"><link rel="prefetch" href="/assets/js/40.b8d5bbf4.js"><link rel="prefetch" href="/assets/js/41.ea4edc48.js"><link rel="prefetch" href="/assets/js/42.772aa8ee.js"><link rel="prefetch" href="/assets/js/43.bb7e9285.js"><link rel="prefetch" href="/assets/js/44.45df278e.js"><link rel="prefetch" href="/assets/js/45.d55cceca.js"><link rel="prefetch" href="/assets/js/46.0c8c51d9.js"><link rel="prefetch" href="/assets/js/47.0e96e931.js"><link rel="prefetch" href="/assets/js/48.7cd0eba4.js"><link rel="prefetch" href="/assets/js/49.e46e4b79.js"><link rel="prefetch" href="/assets/js/5.2729aef4.js"><link rel="prefetch" href="/assets/js/50.92ba3da6.js"><link rel="prefetch" href="/assets/js/51.0202291b.js"><link rel="prefetch" href="/assets/js/52.f92048a9.js"><link rel="prefetch" href="/assets/js/53.07ceccc9.js"><link rel="prefetch" href="/assets/js/54.4e07b215.js"><link rel="prefetch" href="/assets/js/55.2e2bb8d4.js"><link rel="prefetch" href="/assets/js/56.45e214fe.js"><link rel="prefetch" href="/assets/js/57.4ce4a530.js"><link rel="prefetch" href="/assets/js/58.f5cb3725.js"><link rel="prefetch" href="/assets/js/59.d876d40f.js"><link rel="prefetch" href="/assets/js/6.18289d2c.js"><link rel="prefetch" href="/assets/js/60.23938f5e.js"><link rel="prefetch" href="/assets/js/61.80196175.js"><link rel="prefetch" href="/assets/js/62.5f2ced9c.js"><link rel="prefetch" href="/assets/js/63.424361b5.js"><link rel="prefetch" href="/assets/js/65.dc44ac45.js"><link rel="prefetch" href="/assets/js/66.bac24f77.js"><link rel="prefetch" href="/assets/js/67.f2e38f54.js"><link rel="prefetch" href="/assets/js/68.8eab7a58.js"><link rel="prefetch" href="/assets/js/69.73bfbfca.js"><link rel="prefetch" href="/assets/js/7.9ce784ab.js"><link rel="prefetch" href="/assets/js/8.5a0ba8cc.js"><link rel="prefetch" href="/assets/js/9.e78313b5.js">
    <link rel="stylesheet" href="/assets/css/0.styles.be1758fe.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="ç›®å½•" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.png" alt="" class="logo"> <!----></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">é¦–é¡µ</a></div><div class="nav-item"><a href="/pages/259a4b/" class="nav-link">æ–‡ç« </a></div><div class="nav-item"><a href="/pages/1b12ed/" class="nav-link">è”ç³»æˆ‘</a></div> <a href="https://github.com/2382546457" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><!----> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">é¦–é¡µ</a></div><div class="nav-item"><a href="/pages/259a4b/" class="nav-link">æ–‡ç« </a></div><div class="nav-item"><a href="/pages/1b12ed/" class="nav-link">è”ç³»æˆ‘</a></div> <a href="https://github.com/2382546457" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/pages/259a4b/" class="sidebar-link">è¯´æ˜</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JavaåŸºç¡€</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>MySQL</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Redis</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>æ“ä½œç³»ç»Ÿ</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>è®¡ç®—æœºç½‘ç»œ</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Javaå¹¶å‘</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>ç®—æ³•</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>æ¡†æ¶</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>ç†è®º</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Spring</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>å¾®æœåŠ¡ä¸­é—´ä»¶çš„ä½¿ç”¨</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>Sentinel</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/3d8a71/" class="sidebar-link">1. Sentinelä¸­çš„ä¸€äº›æ¦‚å¿µä¸æ ¸å¿ƒç±»è§£æ</a></li><li><a href="/pages/51db55/" aria-current="page" class="active sidebar-link">2. Sentinel è´£ä»»é“¾æµç¨‹</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/pages/51db55/#_1-ç®€è¿°" class="sidebar-link">1. ç®€è¿°</a></li><li class="sidebar-sub-header level2"><a href="/pages/51db55/#_2-processorslot" class="sidebar-link">2. ProcessorSlot</a></li><li class="sidebar-sub-header level2"><a href="/pages/51db55/#_3-processorslotchain" class="sidebar-link">3. ProcessorSlotChain</a></li><li class="sidebar-sub-header level2"><a href="/pages/51db55/#_4-slotchainbuilder" class="sidebar-link">4. SlotChainBuilder</a></li><li class="sidebar-sub-header level2"><a href="/pages/51db55/#_5-æ€»ç»“" class="sidebar-link">5. æ€»ç»“</a></li><li class="sidebar-sub-header level2"><a href="/pages/51db55/#_6-sentinel-ä¸­çš„-spi-æœºåˆ¶" class="sidebar-link">6. Sentinel ä¸­çš„ SPI æœºåˆ¶</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/51db55/#_1-ä»€ä¹ˆæ˜¯-spi" class="sidebar-link">1. ä»€ä¹ˆæ˜¯ SPI</a></li><li class="sidebar-sub-header level3"><a href="/pages/51db55/#_2-ä½¿ç”¨javaçš„spiæœºåˆ¶" class="sidebar-link">2. ä½¿ç”¨Javaçš„SPIæœºåˆ¶</a></li><li class="sidebar-sub-header level3"><a href="/pages/51db55/#_3-sentinel-ä½¿ç”¨-spi-æœºåˆ¶åšäº†ä»€ä¹ˆ" class="sidebar-link">3. Sentinel ä½¿ç”¨ SPI æœºåˆ¶åšäº†ä»€ä¹ˆ</a></li></ul></li></ul></li><li><a href="/pages/f4866d/" class="sidebar-link">3. Sentinel - NodeSelectorSlot</a></li><li><a href="/pages/df7ccb/" class="sidebar-link">4. Sentinel - ClusterBuilderSlot</a></li></ul></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>RocketMQ</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>XXL-JOB</span> <span class="arrow right"></span></p> <!----></section></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>å…¶ä»–</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>è¸©å‘</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>å®ä¹ å°ç»“</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/" title="é¦–é¡µ" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><span data-v-06225672>æ–‡ç« </span></li><li data-v-06225672><span data-v-06225672>æ¡†æ¶</span></li><li data-v-06225672><span data-v-06225672>Sentinel</span></li></ul> <div class="info" data-v-06225672><div title="ä½œè€…" class="author iconfont icon-touxiang" data-v-06225672><a href="https://github.com/2382546457" target="_blank" title="ä½œè€…" class="beLink" data-v-06225672>ä½•</a></div> <div title="åˆ›å»ºæ—¶é—´" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2023-11-29</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">ç›®å½•</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABKFJREFUSA3tVl1oFVcQnrMbrak3QUgkya1akpJYcrUtIqW1JvFBE9LiQ5v6JmJpolbMg32rVrhgoYK0QiMY6i9Y6EMaW5D+xFJaTYItIuK2Kr3+BJNwkxBj05sQY3b3nM6cs2dv9t7NT/vQJw/sndk5M/PNzJkzewGerP+pAmy+ON8lLzUJgA8ZYxYIYZmGYRnctDaWvJJAmTtfP1pvXsBCCPP8QFcCaRkZYACgDZFO4stNIcBCajEOlmmC9XpJ9bAGCaPaPmzPl32dvLSVu3BWCTQs0XQQ6g0DYgwLIoAZbBCdW/i+781o1VVlm/410mw4h06Y7bIPHNyWDyL4FHkX03Q8SrzNhZTZriieckWt7cL6MM85YcLpsi/7O9/iXFT6MswI0DmmpkSaJ0qLxFIm3+i1THHB3zmBH3PYx9CcykcLOeQVVa7QtdxTgQgEleX2AjHYfwA+2ddV77ruGoJUbhGDI09YSNXyMpUt5ylOzxgbUmtOp7NmbNt8v3arjTBfYELmLUV+M+nSawNNAUqpT3ClJWg5I3BLT+cGW/DXNGCa6tx1aakCGEigArTn4TDIPdrXXYKCZNrHLMCOEPvHBlLQ99s9eHB7EB6NTki73CVPQ2F5MSx/uRQixfmq7rK0wYD8w8E905bnPDfwoWs/rfv93NWN/ZfvwsLIU7A09gxECyISeGJkHAau98L97tuw7NXnoPyNF8FcYGLGKsOs0mN3OEyec9esGW/ZEl945dTP34wlR2FZVQWU1q0Cw8Tr7p+hgLLNL0FPxx/Q35mA8aEUrH6nCgwEl0tn7wUiZYJnNRh6DK4UH/k0lfyrsBKdPVv/AriGIQcEDQZ65LBAGe2Rzui9Ybjz7XUppz1/uKBbyVPGkN3ZAeC6hr0x7Nr38N5+EqkoOm17xpoqR9ohQF55ERSvr4Dkr3chNfC3DMzGJlNBElW8w9nsGQvhNGIzDkXzCg8cLK951xHsFBlTJspJNi3ZFIMF2AeDV3q8DNOB+YHi6QTrChDIWDBRi5U5f+ZMfJLu3ccrqxtdxk4SKH336LFxSmkqefwU5T8fhdSdQf9IVKD6aNiwI/hnmcAZ91isYMJIaCUCx9W098+LgruikeTqzqqxKPUwqJyCPJiyemVVZBOijDGjD38Os0jOiSPL1z3SPjXNANbiNPXAdzTfukjjuknNBbyz3nwgTd3AVFqUJ5hpHlq9MveLnWwttUfoygBmvVjuikxND3znrhsELnZk7k+OjIGxeNEkomyLVta0xxn+HZhjBc4YZ/AFjHjz9u3xRZl2BN4aq9nFwWh16IrQ1aHHEd3j1+4/dB9OtH4e29A2H1DyHQRmOSfQZ1Fy7MHBTGB6J/Djq6p3OxyO2cB+4Car7v/o3GXgfAkj23+x9ID1Teoamo/SXcbvSf2PX7Vc8DdCmE1vN9di+32P9/5YR3vLnhCVGUWBjEkr3yh4H8v9CzmsbdhzOKzsJKM90iFdaTMjRPhGVsakRvOaRidljo6H6G7j+ctrJpsP+4COhDIl0La2+FS4+5mlocBaXY5QnGZysIBYoeSsl5qQzrSj/cgNrfuEzlWBfwA+EjrZyWUvpAAAAABJRU5ErkJggg==">2. Sentinel è´£ä»»é“¾æµç¨‹<!----></h1>  <div class="theme-vdoing-content content__default"><h2 id="_1-ç®€è¿°"><a href="#_1-ç®€è¿°" class="header-anchor">#</a> 1. ç®€è¿°</h2> <p>åœ¨ä¸Šä¸€ç¯‡ä¸­è¯¦ç»†ä»‹ç»äº† Sentinel ä¸­çš„å‡ ä¸ªæ ¸å¿ƒç±»ï¼Œåˆç®€å•è¯´äº†ä¸€ä¸‹ Sentinel çš„æ’æ§½ã€‚</p> <p>è¿™ä¸€ç¯‡ä¼šç¨å¾®è¯¦ç»†çš„è®²è§£æ’æ§½ï¼Œä¼šä»æ•´ä½“ä¹Ÿå°±æ˜¯è´£ä»»é“¾æ¨¡å¼å…¥æ‰‹ä»‹ç» Sentinel å·¥ä½œçš„æµç¨‹ï¼Œä½†ä¸ä¼šå•ç‹¬è®²è§£æŸä¸€ä¸ªæ’æ§½çš„ç”¨å¤„ã€‚</p> <p>å›å¿†ä¸€ä¸‹ä¸Šä¸€ç¯‡æœ‰å…³æ’æ§½ ProcessorSlot çš„çŸ¥è¯†ç‚¹ ï¼š</p> <p>Sentinel ä½¿ç”¨ è´£ä»»é“¾æ¨¡å¼å°†æ‰€æœ‰çš„ ProcessorSlot æŒ‰ç…§ä¸€å®šçš„é¡ºåºä¸²æˆä¸€ä¸ªé“¾è¡¨ã€‚ProcessorSlot å…±åˆ†ä¸ºä¸¤ç±»ï¼š</p> <ol><li><p>ç»Ÿè®¡æ•°æ®ï¼Œè¿™ç§ ProcessorSlor æ˜¯æœ‰ä¸¥æ ¼çš„é¡ºåºåŒºåˆ†çš„ï¼Œä¸èƒ½æ›´æ”¹ã€‚</p> <p>NodeSelectorSlot</p> <p>ClusterBuilderSlot</p> <p>StatisticSlot</p></li> <li><p>é™æµ/ç†”æ–­ï¼Œè¿™ç§ ProcessorSlot æ²¡æœ‰ä¸¥æ ¼ä¸¥æ ¼çš„é¡ºåºè¦æ±‚ï¼Œå¯ä»¥æŒ‰éœ€è°ƒæ•´ã€‚</p> <p>AuthoritySlot</p> <p>SystemSlot</p> <p>FlowSlot</p> <p>DegradeSlot</p></li></ol> <p>ProcessorSlotChain ï¼šå†…å«ProcessorSlotå¤´èŠ‚ç‚¹å’Œå°¾èŠ‚ç‚¹ï¼Œå¯ä»¥è§¦å‘æ•´ä¸ªæ’æ§½é“¾çš„æ‰§è¡Œã€‚</p> <p>SlotChainBuilder ï¼šå°† ProcessorSlot ç»„è£…èµ·æ¥å½¢æˆ ProcessorSlotChain å¹¶è¿”å›ç»™ç”¨æˆ·ã€‚</p> <p>æ¥ä¸‹æ¥è¯¦ç»†è¯´è¯´ Sentinel çš„å·¥ä½œæµç¨‹</p> <h2 id="_2-processorslot"><a href="#_2-processorslot" class="header-anchor">#</a> 2. ProcessorSlot</h2> <p>ProcessorSlot æ˜¯ä¸€ä¸ªæ¥å£</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">ProcessorSlot</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>

  	<span class="token comment">// å®ç°è‡ªå·±çš„ä¸šåŠ¡æ–¹æ³•</span>
    <span class="token keyword">void</span> <span class="token function">entry</span><span class="token punctuation">(</span><span class="token class-name">Context</span> context<span class="token punctuation">,</span> <span class="token class-name">ResourceWrapper</span> resourceWrapper<span class="token punctuation">,</span> <span class="token class-name">T</span> param<span class="token punctuation">,</span> <span class="token keyword">int</span> count<span class="token punctuation">,</span> <span class="token keyword">boolean</span> prioritized<span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Throwable</span><span class="token punctuation">;</span>

    <span class="token comment">// è§¦å‘ä¸‹ä¸€ä¸ªslotçš„ä¸šåŠ¡æ–¹æ³•</span>
    <span class="token keyword">void</span> <span class="token function">fireEntry</span><span class="token punctuation">(</span><span class="token class-name">Context</span> context<span class="token punctuation">,</span> <span class="token class-name">ResourceWrapper</span> resourceWrapper<span class="token punctuation">,</span> <span class="token class-name">Object</span> obj<span class="token punctuation">,</span> <span class="token keyword">int</span> count<span class="token punctuation">,</span> <span class="token keyword">boolean</span> prioritized<span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Throwable</span><span class="token punctuation">;</span>

	<span class="token comment">// å®ç°è‡ªå·±çš„é€€å‡ºæ–¹æ³•</span>
    <span class="token keyword">void</span> <span class="token function">exit</span><span class="token punctuation">(</span><span class="token class-name">Context</span> context<span class="token punctuation">,</span> <span class="token class-name">ResourceWrapper</span> resourceWrapper<span class="token punctuation">,</span> <span class="token keyword">int</span> count<span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// è§¦å‘ä¸‹ä¸€ä¸ªslotçš„é€€å‡ºæ–¹æ³•</span>
    <span class="token keyword">void</span> <span class="token function">fireExit</span><span class="token punctuation">(</span><span class="token class-name">Context</span> context<span class="token punctuation">,</span> <span class="token class-name">ResourceWrapper</span> resourceWrapper<span class="token punctuation">,</span> <span class="token keyword">int</span> count<span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>context ï¼šå½“å‰è°ƒç”¨é“¾è·¯ä¸Šä¸‹æ–‡</li> <li>resourceWrapper ï¼šèµ„æº</li> <li>param ï¼šæ³›å‹å‚æ•°ï¼Œä¸€èˆ¬ç”¨äºä¼ é€’ DefaultNode</li> <li>count ï¼šç”³è¯·è®¿é—®èµ„æºçš„æ•°é‡ï¼Œæ¯”å¦‚è®¿é—®é‡ã€å ç”¨çº¿ç¨‹æ•°é‡ï¼Œcount ä¸€èˆ¬ä¸º1</li> <li>prioritized ï¼šæ˜¯å¦å¯¹è¯·æ±‚è¿›è¡Œä¼˜å…ˆçº§æ’åºï¼Œä¸€èˆ¬ä¸ºfalse</li> <li>args ï¼šè°ƒç”¨æ–¹æ³•çš„å‚æ•°ï¼Œç”¨äºå®ç°çƒ­ç‚¹å‚æ•°é™æµ</li></ul> <p>è¿™é‡Œä½ å°±ä¼šæœ‰äº›ç–‘æƒ‘ï¼ŒæŒ‰ç…§è´£ä»»é“¾æ¨¡å¼ï¼ŒProcessorChain åº”è¯¥æœ‰ä¸€ä¸ª next å˜é‡ç”¨äºä¸²èµ·æ¥æ‰€æœ‰ ProcessorChain å•Šï¼Œä½†æ˜¯æ­¤å¤„å¹¶æ²¡æœ‰ï¼Œè€Œä¸”ä¹Ÿæ²¡æœ‰æä¾›<code>æ·»åŠ ä¸‹ä¸€ä¸ªslot</code>ã€<code>è§¦å‘ä¸‹ä¸€ä¸ªslot</code>è¿™äº›æ–¹æ³•ï¼Œä¸è¦æ…Œï¼Œå…¶å®è¿™äº›ä¸œè¥¿åœ¨ ProcessorSlot çš„å®ç°ç±»ä¸­ ï¼šAbstractLinkedProcessorSlot</p> <p>ä¹‹æ‰€ä»¥èƒ½å¤Ÿå°†æ‰€æœ‰çš„ ProcessorSlot æ„é€ æˆä¸€ä¸ª ProcessorSlotChainï¼Œè¿˜æ˜¯ä¾èµ– AbstractLinkedProcessorSlot ç±»ã€‚</p> <p>æ¯ä¸ª AbstractLinkedProcessorSlot ç±»éƒ½æœ‰ä¸€ä¸ªæŒ‡å‘ä¸‹ä¸€ä¸ª AbstractLinkedProcessorSlot çš„å­—æ®µï¼Œæ­£æ˜¯è¿™ä¸ªå­—æ®µå°† ProcessorSlot ä¸²æˆä¸€æ¡å•å‘é“¾è¡¨ã€‚AbstractLinkedProcessorSlot éƒ¨åˆ†æºç å¦‚ä¸‹ã€‚</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">AbstractLinkedProcessorSlot</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">implements</span> <span class="token class-name">ProcessorSlot</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
    <span class="token comment">// å½“å‰èŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹</span>
    <span class="token keyword">private</span> <span class="token class-name">AbstractLinkedProcessorSlot</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> next <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setNext</span><span class="token punctuation">(</span><span class="token class-name">AbstractLinkedProcessorSlot</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> next<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>next <span class="token operator">=</span> next<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">fireEntry</span><span class="token punctuation">(</span><span class="token class-name">Context</span> context<span class="token punctuation">,</span> 
                          <span class="token class-name">ResourceWrapper</span> resourceWrapper<span class="token punctuation">,</span> 
                          <span class="token class-name">Object</span> obj<span class="token punctuation">,</span> 
                          <span class="token keyword">int</span> count<span class="token punctuation">,</span> 
                          <span class="token keyword">boolean</span> prioritized<span class="token punctuation">,</span> 
                          <span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Throwable</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>next <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">T</span> t <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">T</span><span class="token punctuation">)</span> obj<span class="token punctuation">;</span> 
            <span class="token comment">// è°ƒç”¨ä¸‹ä¸€ä¸ª ProcessorSlot çš„ entry æ–¹æ³•</span>
            next<span class="token punctuation">.</span><span class="token function">entry</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span>resourceWrapper<span class="token punctuation">,</span>t<span class="token punctuation">,</span>count<span class="token punctuation">,</span>prioritized<span class="token punctuation">,</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>å¯ä»¥çœ‹åˆ°ï¼Œä¸ä»…æä¾›äº† setNext() æ–¹æ³•ç”¨äºæ·»åŠ æ­¤slotçš„ä¸‹ä¸€ä¸ªslotï¼Œè¿˜æä¾›äº† fireEntry() è§¦å‘ä¸‹ä¸€ä¸ªslotã€‚</p> <p>åˆ°æ—¶å€™æˆ‘ä»¬å®ç°çš„æ—¶å€™åªéœ€è¦è¿™æ ·ï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MySlot</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractLinkedProcessorSlot</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">DefaultNode</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">entry</span><span class="token punctuation">(</span><span class="token class-name">Context</span> context<span class="token punctuation">,</span> 
                      <span class="token class-name">ResourceWrapper</span> resourceWrapper<span class="token punctuation">,</span> 
                      <span class="token class-name">DefaultNode</span> node<span class="token punctuation">,</span> 
                      <span class="token keyword">int</span> count<span class="token punctuation">,</span> 
                      <span class="token keyword">boolean</span> prioritized<span class="token punctuation">,</span> 
                      <span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Throwable</span> <span class="token punctuation">{</span>
        <span class="token comment">// æ‰§è¡Œè‡ªå·±çš„ä¸šåŠ¡æ–¹æ³•...</span>
        
        
        <span class="token comment">// æ‰§è¡Œç»“æŸï¼Œè§¦å‘ä¸‹ä¸€ä¸ªslotçš„ä¸šåŠ¡æ–¹æ³•</span>
        <span class="token function">fireEntry</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> resourceWrapper<span class="token punctuation">,</span> node<span class="token punctuation">,</span> count<span class="token punctuation">,</span> prioritized<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_3-processorslotchain"><a href="#_3-processorslotchain" class="header-anchor">#</a> 3. ProcessorSlotChain</h2> <p>æ ¹æ®è´£ä»»é“¾æ¨¡å¼çš„ä¸€èˆ¬å®ç°æ–¹å¼ï¼Œè¿™ä¸ª Chain ä¼šæŒæœ‰æ‰€æœ‰çš„slotï¼ŒSentinel çš„å®ç°æ–¹å¼æ˜¯æŒæœ‰å¤´èŠ‚ç‚¹å’Œå°¾èŠ‚ç‚¹ã€‚</p> <p>ï¼ˆOkHttpçš„å®ç°æ–¹å¼æ˜¯æŒæœ‰æ•´ä¸ªListï¼‰</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DefaultProcessorSlotChain</span> <span class="token keyword">extends</span> <span class="token class-name">ProcessorSlotChain</span> <span class="token punctuation">{</span>

    <span class="token comment">// è™šæ‹Ÿå¤´èŠ‚ç‚¹</span>
    <span class="token class-name">AbstractLinkedProcessorSlot</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> first <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AbstractLinkedProcessorSlot</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token comment">// å¯ä»¥çœ‹åˆ°å¤´èŠ‚ç‚¹å¹¶æ²¡æœ‰è‡ªå·±çš„ä¸šåŠ¡éœ€è¦å®ç°ï¼Œæ‰€ä»¥ç›´æ¥è°ƒç”¨ fireEntry è§¦å‘next.entry</span>
        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">entry</span><span class="token punctuation">(</span><span class="token class-name">Context</span> context<span class="token punctuation">,</span> <span class="token class-name">ResourceWrapper</span> resourceWrapper<span class="token punctuation">,</span> <span class="token class-name">Object</span> t<span class="token punctuation">,</span> <span class="token keyword">int</span> count<span class="token punctuation">,</span> <span class="token keyword">boolean</span> prioritized<span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> args<span class="token punctuation">)</span>
            <span class="token keyword">throws</span> <span class="token class-name">Throwable</span> <span class="token punctuation">{</span>
            <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">fireEntry</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> resourceWrapper<span class="token punctuation">,</span> t<span class="token punctuation">,</span> count<span class="token punctuation">,</span> prioritized<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">exit</span><span class="token punctuation">(</span><span class="token class-name">Context</span> context<span class="token punctuation">,</span> <span class="token class-name">ResourceWrapper</span> resourceWrapper<span class="token punctuation">,</span> <span class="token keyword">int</span> count<span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">fireExit</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> resourceWrapper<span class="token punctuation">,</span> count<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token comment">// å°¾èŠ‚ç‚¹</span>
    <span class="token class-name">AbstractLinkedProcessorSlot</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> end <span class="token operator">=</span> first<span class="token punctuation">;</span>

    <span class="token comment">// å¤´æ’æ³•</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addFirst</span><span class="token punctuation">(</span><span class="token class-name">AbstractLinkedProcessorSlot</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> protocolProcessor<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        protocolProcessor<span class="token punctuation">.</span><span class="token function">setNext</span><span class="token punctuation">(</span>first<span class="token punctuation">.</span><span class="token function">getNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        first<span class="token punctuation">.</span><span class="token function">setNext</span><span class="token punctuation">(</span>protocolProcessor<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>end <span class="token operator">==</span> first<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            end <span class="token operator">=</span> protocolProcessor<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// å°¾æ’æ³•</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addLast</span><span class="token punctuation">(</span><span class="token class-name">AbstractLinkedProcessorSlot</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> protocolProcessor<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        end<span class="token punctuation">.</span><span class="token function">setNext</span><span class="token punctuation">(</span>protocolProcessor<span class="token punctuation">)</span><span class="token punctuation">;</span>
        end <span class="token operator">=</span> protocolProcessor<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setNext</span><span class="token punctuation">(</span><span class="token class-name">AbstractLinkedProcessorSlot</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> next<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">addLast</span><span class="token punctuation">(</span>next<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">AbstractLinkedProcessorSlot</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> <span class="token function">getNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> first<span class="token punctuation">.</span><span class="token function">getNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
	<span class="token comment">// entryæ–¹æ³•ï¼Œè°ƒç”¨ first.transformEntry()ï¼Œæœ€ç»ˆè°ƒç”¨åˆ° first.entryï¼Œ</span>
    <span class="token comment">// first.entryæ²¡æœ‰è‡ªå·±çš„ä¸šåŠ¡ï¼Œç›´æ¥è§¦å‘first.next.entry()</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">entry</span><span class="token punctuation">(</span><span class="token class-name">Context</span> context<span class="token punctuation">,</span> <span class="token class-name">ResourceWrapper</span> resourceWrapper<span class="token punctuation">,</span> <span class="token class-name">Object</span> t<span class="token punctuation">,</span> <span class="token keyword">int</span> count<span class="token punctuation">,</span> <span class="token keyword">boolean</span> prioritized<span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> args<span class="token punctuation">)</span>
        <span class="token keyword">throws</span> <span class="token class-name">Throwable</span> <span class="token punctuation">{</span>
        first<span class="token punctuation">.</span><span class="token function">transformEntry</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> resourceWrapper<span class="token punctuation">,</span> t<span class="token punctuation">,</span> count<span class="token punctuation">,</span> prioritized<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">exit</span><span class="token punctuation">(</span><span class="token class-name">Context</span> context<span class="token punctuation">,</span> <span class="token class-name">ResourceWrapper</span> resourceWrapper<span class="token punctuation">,</span> <span class="token keyword">int</span> count<span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        first<span class="token punctuation">.</span><span class="token function">exit</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> resourceWrapper<span class="token punctuation">,</span> count<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ä½¿ç”¨ ProcessorSlotChain.entry() å³å¯è§¦å‘æ•´ä¸ªé“¾æ¡ã€‚</p> <h2 id="_4-slotchainbuilder"><a href="#_4-slotchainbuilder" class="header-anchor">#</a> 4. SlotChainBuilder</h2> <p>æ ¹æ®è´£ä»»é“¾æ¨¡å¼çš„ä¸€èˆ¬å®ç°æ–¹å¼ï¼Œæ„é€  slot é“¾æ¡è¿™ä»¶äº‹ä¸ä¼šæš´éœ²ç»™ç”¨æˆ·çš„ï¼Œæ‰€ä»¥ Sentintl ä½¿ç”¨ SlotChainBuilder æ„é€  ProcessorSlotChain å¹¶è¿”å›ã€‚</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Spi</span><span class="token punctuation">(</span>isDefault <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DefaultSlotChainBuilder</span> <span class="token keyword">implements</span> <span class="token class-name">SlotChainBuilder</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">ProcessorSlotChain</span> <span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ProcessorSlotChain</span> chain <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DefaultProcessorSlotChain</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ProcessorSlot</span><span class="token punctuation">&gt;</span></span> sortedSlotList <span class="token operator">=</span> <span class="token class-name">SpiLoader</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token class-name">ProcessorSlot</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">loadInstanceListSorted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">ProcessorSlot</span> slot <span class="token operator">:</span> sortedSlotList<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>slot <span class="token keyword">instanceof</span> <span class="token class-name">AbstractLinkedProcessorSlot</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">RecordLog</span><span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">&quot;The ProcessorSlot(&quot;</span> <span class="token operator">+</span> slot<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getCanonicalName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;) is not an instance of AbstractLinkedProcessorSlot, can't be added into ProcessorSlotChain&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">continue</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            chain<span class="token punctuation">.</span><span class="token function">addLast</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">AbstractLinkedProcessorSlot</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span> slot<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">return</span> chain<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ä½†æ˜¯æ‰“çœ¼ä¸€çœ‹æ²¡è¿™ä¹ˆç®€å•ï¼å¹¶æ²¡æœ‰æˆ‘ä»¬æƒ³è±¡çš„ new äº†å¾ˆå¤š slot ç„¶åä¸€ä¸ªä¸€ä¸ª add è¿›å»ï¼Œè€Œæ˜¯ä½¿ç”¨ SpiLoader åŠ è½½ã€‚è¿™æ˜¯ Java SPI æœºåˆ¶ï¼Œæˆ‘ä»¬åœ¨ä¸‹é¢ä¼šä»‹ç»ï¼Œè¿™é‡Œå°±ä¸‘é™‹ä¸€ç‚¹ä¸€ä¸ªä¸€ä¸ªnewå‡ºæ¥ğŸ˜</p> <p>æˆ‘æ‰‹åŠ¨ new çš„å“ˆï¼Œæºç é‡Œé¢æ²¡æœ‰</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DefaultSlotChainBuilder</span> <span class="token keyword">implements</span> <span class="token class-name">SlotChainBuilder</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">ProcessorSlotChain</span> <span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ProcessorSlotChain</span> chain <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DefaultProcessorSlotChain</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        chain<span class="token punctuation">.</span><span class="token function">addLast</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">NodeSelectorSlot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        chain<span class="token punctuation">.</span><span class="token function">addLast</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ClusterBuilderSlot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        chain<span class="token punctuation">.</span><span class="token function">addLast</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">LogSlot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        chain<span class="token punctuation">.</span><span class="token function">addLast</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">StatisticSlot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        chain<span class="token punctuation">.</span><span class="token function">addLast</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">AuthoritySlot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        chain<span class="token punctuation">.</span><span class="token function">addLast</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">SystemSlot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        chain<span class="token punctuation">.</span><span class="token function">addLast</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FlowSlot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        chain<span class="token punctuation">.</span><span class="token function">addLast</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">DegradeSlot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        chain<span class="token punctuation">.</span><span class="token function">addLast</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">DefaultCircuitBreakerSlot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token keyword">return</span> chain<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_5-æ€»ç»“"><a href="#_5-æ€»ç»“" class="header-anchor">#</a> 5. æ€»ç»“</h2> <ol><li>ProcessorSlotChain ï¼š
<ul><li><font color="Blue">firstSlot</font> ï¼šfirst.entryæ–¹æ³•ç›´æ¥è°ƒç”¨fireEntryæ–¹æ³•</li> <li><font color="Blue">endSlot</font></li> <li><font color="Bule">entry()</font> ï¼šè°ƒç”¨firstSlotçš„entryæ–¹æ³•</li></ul></li> <li>ProcessorSlot
<ul><li><font color="Blue">nextSlot</font></li> <li><font color="Bule">entry()</font> ï¼šæ‰§è¡Œå®Œè‡ªå·±çš„ä¸šåŠ¡åæ‰§è¡Œ fireEntry()</li> <li><font color="Bule">fireEntry() </font>ï¼šæ‰§è¡Œ next.entry()</li></ul></li></ol> <p>æ€»æµç¨‹ ï¼š</p> <ol><li>ä½¿ç”¨ SlotChainBuilder åˆ›å»º ProcessorSlotChain</li> <li>ä½¿ç”¨ ProcessorSlotChain.entry() æ–¹æ³•å¯ä»¥æ‰§è¡Œæ•´æ¡æ’æ§½é“¾ ï¼š
<ul><li>è°ƒç”¨ firstSlot.entryï¼ŒfirstSlot.entry() ä¸­ç›´æ¥æ‰§è¡Œ fireEntry æ–¹æ³•å»æ‰§è¡Œä¸‹ä¸€ä¸ª slot.entry()</li></ul></li> <li>ä¸‹ä¸€ä¸ª slot.entry() æ‰§è¡Œå®Œè‡ªå·±çš„ä¸šåŠ¡æ–¹æ³•åï¼Œè°ƒç”¨ fireEntry() å»æ‰§è¡Œä¸‹ä¸€ä¸ª slot.entry()</li> <li>....</li> <li>....</li></ol> <h2 id="_6-sentinel-ä¸­çš„-spi-æœºåˆ¶"><a href="#_6-sentinel-ä¸­çš„-spi-æœºåˆ¶" class="header-anchor">#</a> 6. Sentinel ä¸­çš„ SPI æœºåˆ¶</h2> <h3 id="_1-ä»€ä¹ˆæ˜¯-spi"><a href="#_1-ä»€ä¹ˆæ˜¯-spi" class="header-anchor">#</a> 1. ä»€ä¹ˆæ˜¯ SPI</h3> <p>SPI å…¨ç§°æ˜¯ Service Provider Interfaceï¼Œç›´è¯‘å°±æ˜¯æœåŠ¡æä¾›è€…æ¥å£ï¼Œæ˜¯ä¸€ç§æœåŠ¡å‘ç°æœºåˆ¶ï¼Œæ˜¯ Java çš„ä¸€ä¸ªå†…ç½®æ ‡å‡†ï¼Œå…è®¸ä¸åŒçš„å¼€å‘è€…å»å®ç°æŸä¸ªç‰¹å®šçš„æœåŠ¡ã€‚SPI çš„æœ¬è´¨æ˜¯å°†æ¥å£å®ç°ç±»çš„å…¨é™å®šåé…ç½®åœ¨æ–‡ä»¶ä¸­ï¼Œç”±æœåŠ¡åŠ è½½å™¨è¯»å–é…ç½®æ–‡ä»¶ï¼ŒåŠ è½½å®ç°ç±»ï¼Œå®ç°åœ¨è¿è¡Œæ—¶åŠ¨æ€æ›¿æ¢æ¥å£çš„å®ç°ç±»ã€‚</p> <p>ä½¿ç”¨ SPI æœºåˆ¶èƒ½å¤Ÿå®ç°æŒ‰é…ç½®åŠ è½½æ¥å£çš„å®ç°ç±»ï¼ŒSPI æœºåˆ¶åœ¨é˜¿é‡Œå¼€æºçš„é¡¹ç›®ä¸­è¢«å¹¿æ³›ä½¿ç”¨ï¼Œä¾‹å¦‚ Dubboã€RocketMQã€ä»¥åŠæœ¬æ–‡ä»‹ç»çš„ Sentinelã€‚RocketMQ ä¸ Sentinel ä½¿ç”¨çš„éƒ½æ˜¯ Java æä¾›çš„ SPI æœºåˆ¶ï¼Œè€Œ Dubbo åˆ™æ˜¯ä½¿ç”¨è‡ªå®ç°çš„ä¸€å¥— SPIï¼Œä¸ Java SPI çš„é…ç½®æ–¹å¼ä¸åŒï¼ŒDubbo SPI ä½¿ç”¨ Key-Value æ–¹å¼é…ç½®ï¼Œç›®çš„æ˜¯å®ç°è‡ªé€‚åº”æ‰©å±•æœºåˆ¶ã€‚</p> <p>Java çš„ SPI æœºåˆ¶æä¾›äº† ServiceLoader.load(Class&lt;?&gt; clazz) ç”¨äºåŠ è½½æŒ‡å®šç±»çš„å®ç°ç±»ã€‚å®ƒåŠ è½½æ–‡ä»¶çš„è·¯å¾„ä¸ºï¼š</p> <p><code>resource/META-INF/services/${æ¥å£çš„å…¨é™å®šç±»å}</code>.</p> <p>åœ¨æ–‡ä»¶ä¸­ä¹Ÿè¦å¡«æ¥å£çš„å®ç°ç±»çš„å…¨é™å®šç±»åï¼ŒJavaå°†å…¨éƒ¨çš„å®ç°ç±»è¿”å›ç»™ç”¨æˆ· ï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code>com<span class="token punctuation">.</span>xiaohe<span class="token punctuation">.</span>xxxxxx
</code></pre></div><div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">ServiceLoader</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> services <span class="token operator">=</span> <span class="token class-name">ServiceLoader</span><span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> clazz<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>åŠ è½½æ­¥éª¤ä¸º ï¼š</p> <ul><li>æŒ‡å®š ServiceLoader.load(Class<T> clazz)</T></li> <li>é€šè¿‡ clazz æ‹¿åˆ°æ¥å£çš„å…¨é™å®šç±»åï¼Œå» <code>resource/META-INF/services</code>ç›®å½•ä¸‹å¯»æ‰¾å¯¹åº”å…¨é™å®šç±»åçš„æ–‡ä»¶</li> <li>è¯»å–è¯¥æ–‡ä»¶çš„å…¨éƒ¨å†…å®¹ï¼ˆæ¯ä¸€ä¸ªå†…å®¹ä»¥æ¢è¡Œç¬¦åˆ†éš”ï¼‰</li> <li>ä»¥é›†åˆçš„å½¢å¼è¿”å›ç»™ç”¨æˆ·</li></ul> <h3 id="_2-ä½¿ç”¨javaçš„spiæœºåˆ¶"><a href="#_2-ä½¿ç”¨javaçš„spiæœºåˆ¶" class="header-anchor">#</a> 2. ä½¿ç”¨Javaçš„SPIæœºåˆ¶</h3> <p>å‡è®¾æœ‰å¾ˆå¤šç§ç™»å½•æ–¹å¼ï¼Œæ‰€ä»¥ç™»å½•æ¥å£ï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">LoginService</span><span class="token punctuation">{</span>
  <span class="token keyword">void</span> <span class="token function">login</span><span class="token punctuation">(</span><span class="token class-name">String</span> username<span class="token punctuation">,</span><span class="token class-name">String</span> password<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>æœ‰ä¸¤ä¸ªå®ç°ç±»ï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ShiroLogin</span> <span class="token keyword">implements</span> <span class="token class-name">LoginService</span><span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">login</span><span class="token punctuation">(</span><span class="token class-name">String</span> username<span class="token punctuation">,</span> <span class="token class-name">String</span> password<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;è§¦å‘ Shiro çš„ç™»å½•åŠŸèƒ½&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SpringSecurityLogin</span> <span class="token keyword">implements</span> <span class="token class-name">LoginService</span><span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">login</span><span class="token punctuation">(</span><span class="token class-name">String</span> username<span class="token punctuation">,</span> <span class="token class-name">String</span> password<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;è§¦å‘ SpringSecurity çš„ç™»å½•åŠŸèƒ½&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>åœ¨ <code>resource/META-INF/services</code> ç›®å½•ä¸‹åˆ›å»ºåä¸º <code>com.xiaohe.spi.LoginService</code> ï¼ˆæ¥å£å…¨é™å®šç±»åï¼‰çš„æ–‡ä»¶ï¼Œæ–‡ä»¶ä¸­å¡«å…¥ï¼š</p> <div class="language-markdown extra-class"><pre class="language-markdown"><code>com.xiaohe.spi.SpringSecurityLogin
</code></pre></div><p>æ„ä¸ºåªåŠ è½½ SpringSecurityLogin çš„ç™»é™†æ–¹å¼ã€‚å½“ç„¶ä¹Ÿå¯ä»¥å¡«å¥½å‡ ä¸ªï¼Œå¤šä¸ªä¹‹é—´ä½¿ç”¨æ¢è¡Œåˆ†å¼€ã€‚</p> <p>ç¼–å†™æµ‹è¯•ç±»ï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">ServiceLoader</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">LoginService</span><span class="token punctuation">&gt;</span></span> services <span class="token operator">=</span> <span class="token class-name">ServiceLoader</span><span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token class-name">LoginService</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    services<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>loginService <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
        loginService<span class="token punctuation">.</span><span class="token function">login</span><span class="token punctuation">(</span><span class="token string">&quot;å°æ˜&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;123&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>æ‰“å° ï¼š</p> <div class="language-markdown extra-class"><pre class="language-markdown"><code>è§¦å‘ SpringSecurity çš„ç™»å½•åŠŸèƒ½
</code></pre></div><h3 id="_3-sentinel-ä½¿ç”¨-spi-æœºåˆ¶åšäº†ä»€ä¹ˆ"><a href="#_3-sentinel-ä½¿ç”¨-spi-æœºåˆ¶åšäº†ä»€ä¹ˆ" class="header-anchor">#</a> 3. Sentinel ä½¿ç”¨ SPI æœºåˆ¶åšäº†ä»€ä¹ˆ</h3> <p>æƒ³çŸ¥é“å“ªé‡Œä½¿ç”¨åˆ°äº† SPIï¼Œæœ€å¥½çš„æ–¹å¼å°±æ˜¯å» <code>resource/META-INF/services</code>ç›®å½•ä¸‹æŸ¥çœ‹æœ‰å¤šå°‘ä»¥å…¨é™å®šç±»åå‘½åçš„æ–‡ä»¶ï¼ŒSentinel1.8.1 ç‰ˆæœ¬æœ‰ä¸‰ä¸ªï¼š</p> <p><img src="https://typorehwf.oss-cn-chengdu.aliyuncs.com/image-20231128214014089.png" alt="image-20231128214014089"></p> <p>ç¬¬ä¸€ä¸ªæ²¡è§è¿‡æš‚æ—¶ä¸è¯´ï¼Œä½†æ˜¯ç¬¬äºŒä¸ªå’Œç¬¬ä¸‰ä¸ªå°±å¾ˆæ˜æ˜¾äº†å§ã€‚</p> <p>ä½¿ç”¨SPIæœºåˆ¶åŠ è½½ ProcessorSlot çš„ç›®çš„ ï¼šå¯ä»¥åœ¨æ–‡ä»¶ä¸­è‡ªå®šä¹‰ slot çš„æ‰§è¡Œé¡ºåºã€‚</p> <p>ä½¿ç”¨SPIæœºåˆ¶åŠ è½½ ProcessorSlotChain çš„ç›®çš„ ï¼šå¯ä»¥åœ¨ä»£ç ä¸­è‡ªå®šä¹‰ slot çš„æ‰§è¡Œé¡ºåºã€‚</p> <p>å†æ¥ç¥ä¸€çœ¼ Sentinel ä¸­ DefaultSlotChainBuilder æ„å»º ProcessorSlotChain çš„è¿‡ç¨‹ ï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Spi</span><span class="token punctuation">(</span>isDefault <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DefaultSlotChainBuilder</span> <span class="token keyword">implements</span> <span class="token class-name">SlotChainBuilder</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">ProcessorSlotChain</span> <span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ProcessorSlotChain</span> chain <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DefaultProcessorSlotChain</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ProcessorSlot</span><span class="token punctuation">&gt;</span></span> sortedSlotList <span class="token operator">=</span> <span class="token class-name">SpiLoader</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token class-name">ProcessorSlot</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">loadInstanceListSorted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">ProcessorSlot</span> slot <span class="token operator">:</span> sortedSlotList<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// æ‰€æœ‰ slot å¿…é¡»æ˜¯ AbstractLinkedProcessorSlot çš„å­ç±»</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>slot <span class="token keyword">instanceof</span> <span class="token class-name">AbstractLinkedProcessorSlot</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// æ‰“æ—¥å¿—çš„ä»£ç æˆ‘åˆ äº†</span>
                <span class="token keyword">continue</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            chain<span class="token punctuation">.</span><span class="token function">addLast</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">AbstractLinkedProcessorSlot</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span> slot<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">return</span> chain<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>å†æ¥çœ‹çœ‹ <code>resource/META-INF/services/ProcessorSlot</code> æ–‡ä»¶ä¸­çš„å†…å®¹ ï¼š</p> <div class="language-markdown extra-class"><pre class="language-markdown"><code>com.alibaba.csp.sentinel.slots.nodeselector.NodeSelectorSlot
com.alibaba.csp.sentinel.slots.clusterbuilder.ClusterBuilderSlot
com.alibaba.csp.sentinel.slots.logger.LogSlot
com.alibaba.csp.sentinel.slots.statistic.StatisticSlot
com.alibaba.csp.sentinel.slots.block.authority.AuthoritySlot
com.alibaba.csp.sentinel.slots.system.SystemSlot
com.alibaba.csp.sentinel.slots.block.flow.FlowSlot
com.alibaba.csp.sentinel.slots.block.degrade.DegradeSlot
com.alibaba.csp.sentinel.slots.block.degrade.DefaultCircuitBreakerSlot
</code></pre></div><p>è·Ÿæˆ‘ä¹‹å‰æ‰‹åŠ¨ new çš„æ‰§è¡Œé¡ºåºä¸€æ ·ã€‚åç»­æ–‡ç« å°±ä¼šå¯¹è¿™äº› slot æŒ¨ä¸ªè®²è§£ã€‚</p></div></div>  <div class="page-edit"><!----> <!----> <div class="last-updated"><span class="prefix">ä¸Šæ¬¡æ›´æ–°:</span> <span class="time">2023/12/11, 23:11:06</span></div></div> <div class="page-nav-wapper"><!----> <div class="page-nav"><p class="inner"><span class="prev">
        â†
        <a href="/pages/3d8a71/" class="prev">1. Sentinelä¸­çš„ä¸€äº›æ¦‚å¿µä¸æ ¸å¿ƒç±»è§£æ</a></span> <span class="next"><a href="/pages/f4866d/">3. Sentinel - NodeSelectorSlot</a>â†’
      </span></p></div></div></div> <!----></main></div> <div class="footer"><div class="icons"><a href="3175543112@qq.com" title="å‘é‚®ä»¶" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/2382546457" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://music.163.com/#/playlist?id=755597173" title="å¬éŸ³ä¹" target="_blank" class="iconfont icon-erji"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="æœ¬ç«™ä¸»é¢˜">Vdoing</a> 
    | Copyright Â© 2023-2024
    <span>ä½• | MIT License</span></div> <div class="buttons"><div title="è¿”å›é¡¶éƒ¨" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="å»è¯„è®º" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="ä¸»é¢˜æ¨¡å¼" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          è·Ÿéšç³»ç»Ÿ
        </li><li class="iconfont icon-rijianmoshi">
          æµ…è‰²æ¨¡å¼
        </li><li class="iconfont icon-yejianmoshi">
          æ·±è‰²æ¨¡å¼
        </li><li class="iconfont icon-yuedu">
          é˜…è¯»æ¨¡å¼
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.55b11924.js" defer></script><script src="/assets/js/2.73d4029d.js" defer></script><script src="/assets/js/64.63e35c1a.js" defer></script>
  </body>
</html>
